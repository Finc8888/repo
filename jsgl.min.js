jsgl={elements:{dom:{}},panel:{},path:{},stroke:{},fill:{},util:{}};jsgl.util.BrowserInfo=(function(){__browserinfo=0;document.write("<!--[if vml]><script type='text/javascript'>__browserinfo++;<\/script><![endif]-->");if(document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))){__browserinfo+=2}document.write("<!--[if IE]><script type='text/javascript'>__browserinfo+=4;<\/script><![endif]-->");document.write("<!--[if IE 5.5000]><script type='text/javascript'>__browserinfo+=8;<\/script><![endif]-->");document.write("<!--[if lte IE 6]><script type='text/javascript'>__browserinfo+=32;<\/script><![endif]-->");document.write("<!--[if lte IE 7]><script type='text/javascript'>__browserinfo+=64;<\/script><![endif]-->");if(typeof(window.event)!="undefined"){__browserinfo+=16}this.supportsVml=!!(__browserinfo&1);this.supportsSvg=!!(__browserinfo&2);this.isMSIE=!!(__browserinfo&4);this.isMSIE55=!!(__browserinfo&8);this.usesWindowEvent=!!(__browserinfo&16);this.isMSIElte6=!!(__browserinfo&32);this.isMSIElte7=!!(__browserinfo&&64);this.isOpera=!this.isMSIE&&this.usesWindowEvent;return this})();Function.prototype.jsglExtend=function(ancestor){function F(){}F.prototype=ancestor.prototype;this.prototype=new F();this.prototype.constructor=this;this.base=F.prototype;this.base.constructor=ancestor};Number.prototype.jsglVmlize=function(){return Math.round(this*1000)};jsgl.util.delegate=function(object,method){return function(){return method.apply(object,arguments)}};jsgl.cloneObject=function(obj){if(obj==null||typeof(obj)!="object"){return obj}var temp=new obj.constructor();for(var key in obj){temp[key]=jsgl.cloneObject(obj[key])}return temp};jsgl.util.clone=function(obj){if(obj==null||typeof(obj)!="object"){return obj}var temp=new obj.constructor();for(var key in obj){temp[key]=jsgl.util.clone(obj[key])}return temp};if(navigator.userAgent.indexOf("MSIE 5.0")>0){Function.prototype.call=function(obj){obj.__fnc=this;var __args="";for(var i=1;i<arguments.length;i++){__args+=(i==1?"":",")+"arguments["+i+"]"}return eval("obj.__fnc("+__args+")")};Function.prototype.apply=function(obj,args){obj.__fnc=this;var __args="";for(var i=0;i<args.length;i++){__args+=(i==0?"":",")+"args["+i+"]"}return eval("obj.__fnc("+__args+")")}}jsgl.util.ArrayList=function(){this.items=[];this.count=0};jsgl.util.ArrayList.prototype.add=function(item){if(typeof(item)=="undefined"){return}this.insertAt(item,this.count)};jsgl.util.ArrayList.prototype.clear=function(filter){var f=filter||jsgl.util.ArrayList.DEFAULT_CLEAR_FILTER;var j=0;for(var i=0;i<this.count;i++){if(f(this.items[i])){delete this.items[i]}else{if(i!=j){this.items[j]=this.items[i];delete this.items[i]}j++}}this.count=j};jsgl.util.ArrayList.prototype.contains=function(item){for(var i=0;i<this.count;i++){if(this.items[i]===item){return true}}return false};jsgl.util.ArrayList.prototype.getCount=function(){return this.count};jsgl.util.ArrayList.DEFAULT_CLEAR_FILTER=function(){return true};jsgl.util.ArrayList.prototype.get=function(index){if((index>=0)&&(index<this.count)){return this.items[index]}else{return null}};jsgl.util.ArrayList.prototype.setAt=function(item,index){if(typeof(item)=="undefined"||index<0){return}this.items[index]=item;if(index>=this.count){this.count=index+1}};jsgl.util.ArrayList.prototype.insertAt=function(item,index){if(typeof(item)=="undefined"||index<0){return}for(var i=this.count;i>index;i--){this.items[i]=this.items[i-1]}for(var i=this.count;i<index;i++){this.items[i]=null}this.items[index]=item;if(index>this.count){this.count=index+1}else{this.count++}};jsgl.util.ArrayList.prototype.removeAt=function(index){if(index<0||index>=this.count){return}for(var i=index+1;i<this.count;i++){this.items[i-1]=this.items[i]}this.items[this.count-1]=null;this.count--};jsgl.util.ArrayList.prototype.remove=function(item){this.clear(function(_item){return _item===item})};jsgl.util.ArrayList.prototype.reverse=function(){this.items.reverse()};jsgl.util.ArrayList.prototype.sort=function(comparator){var cmp=function(a,b){var result=(comparator||jsgl.util.ArrayList.DEFAULT_COMPARATOR)(a,b);return(typeof(result)=="number"?result:0)};var c=true;while(c){c=false;for(var i=1;i<this.count;i++){if(cmp(this.items[i-1],this.items[i])<0){c=true;var temp=this.items[i-1];this.items[i-1]=this.items[i];this.items[i]=temp}}}};jsgl.util.ArrayList.DEFAULT_COMPARATOR=function(a,b){return b-a};jsgl.util.ArrayList.prototype.toString=function(index){var itemsStr="";for(var i=0;i<this.count;i++){if(i!=0){itemsStr+=","}itemsStr+=i+":"+this.items[i]}return"ArrayList(count="+this.count+",items=["+itemsStr+"])"};jsgl.util.SortedList=function(comparator){if(comparator){this.comparator=comparator}this.items=[];this.count=0};jsgl.util.SortedList.prototype.comparator=function(a,b){if(b>a){return 1}if(b<a){return -1}return 0};jsgl.util.SortedList.prototype.setComparator=function(comparator){if(comparator){this.comparator=comparator}else{delete this.comparator}};jsgl.util.SortedList.prototype.add=function(item){var pos;if(this.count==0){pos=0}else{var i=this.count;while((i>0)&&(this.comparator(this.items[i-1],item)<0)){i--}pos=i;for(var i=this.count;i>=pos;i--){this.items[i+1]=this.items[i]}}this.items[pos]=item;this.count++};jsgl.util.SortedList.prototype.contains=function(item){for(var i=0;i<this.count;i++){if(this.items[i]==item){return true}}return false};jsgl.util.SortedList.prototype.get=function(index){return this.items[index]};jsgl.util.SortedList.prototype.getCount=function(){return this.count};jsgl.util.SortedList.prototype.remove=function(obj){if(this.count==0){return}for(var i=0;i<this.count;i++){if(this.items[i]==obj){for(var j=i;j<this.count-1;j++){this.items[j]=this.items[j+1]}this.items[this.count-1]=null;this.count--;break}}};jsgl.util.SortedList.prototype.removeAt=function(index){if(index<0||index>=this.count){return}for(var i=index;i<this.count-1;i++){this.items[i]=this.items[i+1]}this.items[this.count-1]=null;this.count--};jsgl.util.SortedList.prototype.toString=function(){var itemsString="";for(var i=0;i<this.count;i++){if(i!=0){itemsString+=","}itemsString+=this.items[i]}return"SortedList(count="+this.count+",items=["+itemsString+"])"};jsgl.util.Queue=function(){this.first=null;this.last=null;this.count=0};jsgl.util.Queue.prototype.enqueue=function(item){if(this.first==null){this.first=this.last={item:item,next:null}}else{this.last.next=this.last={item:item,next:null}}this.count++};jsgl.util.Queue.prototype.dequeue=function(){var result=this.first&&this.first.item;if(this.first!=null){if(this.last==this.first){this.last=null}this.first=this.first.next;this.count--}return result};jsgl.util.Queue.prototype.peek=function(){return this.first&&this.first.item};jsgl.util.Queue.prototype.getCount=function(){return this.count};jsgl.util.Queue.prototype.toString=function(){var itemsStr="";obj=this.first;while(obj){if(obj!=this.first){itemsStr+=","}itemsStr+=obj.item;obj=obj.next}return"Queue(count="+this.getCount()+",items=["+itemsStr+"])"};jsgl.util.CommandQueue=function(){jsgl.util.Queue.call(this);this.stopped=false};jsgl.util.CommandQueue.jsglExtend(jsgl.util.Queue);jsgl.util.CommandQueue.prototype.stop=function(){this.stopped=true};jsgl.util.CommandQueue.prototype.go=function(){while(this.peek()!=null){this.dequeue()}this.stopped=false};jsgl.util.CommandQueue.prototype.enqueue=function(item){if(this.stopped){jsgl.util.Queue.prototype.enqueue.call(this,item)}else{item()}};jsgl.util.CommandQueue.prototype.dequeue=function(){jsgl.util.Queue.prototype.dequeue.call(this)()};jsgl.util.EventRaiser=function(){this.listeners=new jsgl.util.ArrayList();this.commandQueue=new jsgl.util.CommandQueue()};jsgl.util.EventRaiser.prototype.registerListener=function(listener){if(!listener){return}this.commandQueue.enqueue(jsgl.util.delegate(this,function(){this.listeners.add(listener)}))};jsgl.util.EventRaiser.prototype.unregisterListener=function(listener){if(!listener){return}this.commandQueue.enqueue(jsgl.util.delegate(this,function(){this.listeners.remove(listener)}))};jsgl.util.EventRaiser.prototype.raiseEvent=function(eventArgs){this.commandQueue.enqueue(jsgl.util.delegate(this,function(){this.commandQueue.stop();for(var i=0;i<this.listeners.getCount();i++){this.listeners.get(i)(eventArgs)}this.commandQueue.go()}))};jsgl.util.Property=function(value){this.value=value;this.eventRaiser=new jsgl.util.EventRaiser()};jsgl.util.Property.prototype.setValue=function(value){if(this.value!=value){this.value=value;this.eventRaiser.raiseEvent(value)}};jsgl.util.Property.prototype.getValue=function(){return this.value};jsgl.util.Property.prototype.registerChangeListener=function(listener){this.eventRaiser.registerListener(listener)};jsgl.util.Property.prototype.unregisterChangeListener=function(listener){this.eventRaiser.unregisterListener(listener)};jsgl.util.StructuredProperty=function(value){jsgl.util.Property.call(this,value);this.internalChangeListener=jsgl.util.delegate(this.eventRaiser,this.eventRaiser.raiseEvent)};jsgl.util.StructuredProperty.jsglExtend(jsgl.util.Property);jsgl.util.StructuredProperty.prototype.getInternalChangeListener=function(){return this.internalChangeListener};jsgl.util.singletonInstanceGetter=function(){if(!this.instance){this.instance=new this()}return this.instance};jsgl.util.Animator=function(){this.startValue=0;this.endValue=1;this.duration=1000;this.currTime=0;this.reversed=false;this.animRaiser=new jsgl.util.EventRaiser();this.animStartRaiser=new jsgl.util.EventRaiser();this.animEndRaiser=new jsgl.util.EventRaiser();this.prevStepTime=0;this.timer=0;this.fps=jsgl.util.BrowserInfo.isMSIE?10:20;this.repeat=false;this.playing=false};jsgl.util.Animator.prototype.getStartValue=function(){return this.startValue};jsgl.util.Animator.prototype.setStartValue=function(newValue){this.startValue=newValue};jsgl.util.Animator.prototype.getEndValue=function(){return this.endValue};jsgl.util.Animator.prototype.setEndValue=function(newValue){this.endValue=newValue};jsgl.util.Animator.prototype.getDuration=function(){return this.timeStep};jsgl.util.Animator.prototype.setDuration=function(newDuration){this.duration=newDuration};jsgl.util.Animator.prototype.getReversed=function(){return this.reversed};jsgl.util.Animator.prototype.isReversed=function(){return this.reversed};jsgl.util.Animator.prototype.setReversed=function(reversed){this.reversed=reversed};jsgl.util.Animator.prototype.addStartListener=function(listener){this.animStartRaiser.registerListener(listener)};jsgl.util.Animator.prototype.removeStartListener=function(listener){this.animStartRaiser.unregisterListener(listener)};jsgl.util.Animator.prototype.addStepListener=function(listener){this.animRaiser.registerListener(listener)};jsgl.util.Animator.prototype.removeStepListener=function(listener){this.animRaiser.unregisterListener(listener)};jsgl.util.Animator.prototype.addEndListener=function(listener){this.animEndRaiser.registerListener(listener)};jsgl.util.Animator.prototype.removeEndListener=function(listener){this.animEndRaiser.unregisterListener(listener)};jsgl.util.Animator.prototype.step=function(){var currStepTime=(new Date()).getTime();if(this.prevStepTime){this.currTime+=(this.reversed?-1:1)*(currStepTime-this.prevStepTime)}this.currTime=Math.max(0,Math.min(this.currTime,this.duration));var paramValue=this.startValue+(this.currTime/this.duration)*(this.endValue-this.startValue);this.animRaiser.raiseEvent(paramValue);if((!this.reversed&&this.currTime==this.duration)||(this.reversed&&this.currTime==0)){if(this.repeat){this.currTime=this.reversed?this.duration:0;this.prevStepTime=currStepTime}else{window.clearInterval(this.timer);this.playing=false;this.timer=0;this.prevStepTime=0}this.animEndRaiser.raiseEvent()}else{this.prevStepTime=currStepTime}};jsgl.util.Animator.prototype.init=function(){this.animRaiser.raiseEvent(this.startValue+(this.currTime/this.duration)*(this.endValue-this.startValue))};jsgl.util.Animator.prototype.play=function(){if(this.currTime==this.duration&&!this.reversed){this.currTime=0}if(!this.currTime){this.animStartRaiser.raiseEvent()}if(!this.timer){this.step();this.timer=window.setInterval(jsgl.util.delegate(this,this.step),1000/this.fps)}this.playing=true};jsgl.util.Animator.prototype.rewind=function(){this.currTime=0;this.prevStepTime=0};jsgl.util.Animator.prototype.pause=function(){window.clearInterval(this.timer);this.timer=0;this.prevStepTime=0;this.playing=false};jsgl.util.Animator.prototype.stop=function(){window.clearInterval(this.timer);this.timer=0;this.currTime=0;this.prevStepTime=0;this.step();this.currTime=0;this.prevStepTime=0;this.playing=false};jsgl.util.Animator.prototype.setRepeating=function(repeating){this.repeat=repeating};jsgl.util.Animator.prototype.isRepeating=function(){return this.repeat};jsgl.util.Animator.prototype.isPlaying=function(){return this.playing};jsgl.util.Animator.prototype.setFps=function(newFps){this.fps=newFps};jsgl.util.Animator.prototype.getFps=function(){return this.fps};jsgl.Vector2D=function(x,y){this.X=typeof(x)=="number"?x:0;this.Y=typeof(y)=="number"?y:0};jsgl.Vector2D.NULL=new jsgl.Vector2D();jsgl.Vector2D.INVALID=new jsgl.Vector2D(Number.NaN,Number.NaN);jsgl.Vector2D.prototype.getX=function(){return this.X};jsgl.Vector2D.prototype.setX=function(newX){this.X=typeof(newX)=="number"?newX:0};jsgl.Vector2D.prototype.getY=function(){return this.Y};jsgl.Vector2D.prototype.setY=function(newY){this.Y=typeof(newY)=="number"?newY:0};jsgl.Vector2D.prototype.add=function(v){return new jsgl.Vector2D(this.X+v.X,this.Y+v.Y)};jsgl.Vector2D.prototype.subtract=function(v){return new jsgl.Vector2D(this.X-v.X,this.Y-v.Y)};jsgl.Vector2D.prototype.rotate=function(centerX,centerY,angle){var alpha=angle+Math.atan2(this.Y-centerY,this.X-centerX),radius=Math.sqrt((this.X-centerX)*(this.X-centerX)+(this.Y-centerY)*(this.Y-centerY));return new jsgl.Vector2D(centerX+Math.cos(alpha)*radius,centerY+Math.sin(alpha)*radius)};jsgl.Vector2D.prototype.multiply=function(t){return new jsgl.Vector2D(t*this.X,t*this.Y)};jsgl.Vector2D.prototype.round=function(){return new jsgl.Vector2D(Math.round(this.X),Math.round(this.Y))};jsgl.Vector2D.prototype.applyToCSSLocationOf=function(element){element.style.left=this.X+"px";element.style.top=this.Y+"px"};jsgl.Vector2D.prototype.applyToCSSSizeOf=function(element){element.style.width=this.X+"px";element.style.height=this.Y+"px"};jsgl.Vector2D.prototype.equals=function(obj){if(obj==null||typeof(obj)!="object"){return false}if(obj.constructor!=jsgl.Vector2D){return false}return(obj.X==this.X)&&(obj.Y==this.Y)};jsgl.Vector2D.prototype.toString=function(){return this.X+" "+this.Y};jsgl.Vector2D.getDistance=function(vectA,vectB){return Math.sqrt((vectA.X-vectB.X)*(vectA.X-vectB.X)+(vectA.Y-vectB.Y)*(vectA.Y-vectB.Y))};jsgl.stroke.AbstractStroke=function(){this.onChangeRaiser=new jsgl.util.EventRaiser()};jsgl.stroke.AbstractStroke.prototype.applyToSvgElement=function(svgElement){throw"not implemented"};jsgl.stroke.AbstractStroke.prototype.applyToVmlStrokeElement=function(strokeElement){throw"not implemented"};jsgl.stroke.AbstractStroke.prototype.registerChangeListener=function(listener){this.onChangeRaiser.registerListener(listener)};jsgl.stroke.AbstractStroke.prototype.unregisterChangeListener=function(listener){this.onChangeRaiser.unregisterListener(listener)};jsgl.stroke.DisabledStroke=function(){jsgl.stroke.AbstractStroke.call(this)};jsgl.stroke.DisabledStroke.jsglExtend(jsgl.stroke.AbstractStroke);jsgl.stroke.DISABLED=new jsgl.stroke.DisabledStroke();jsgl.stroke.DisabledStroke.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke","none",null)};jsgl.stroke.DisabledStroke.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.on=false};jsgl.stroke.SolidStroke=function(){jsgl.stroke.AbstractStroke.call(this);this.weight=1;this.color="black";this.opacity=1;this.enabled=true;this.dashStyle=new jsgl.stroke.SolidDashStyle();this.endcapType=new jsgl.stroke.RoundEndcapType();this.joinStyle=new jsgl.stroke.RoundJoinStyle()};jsgl.stroke.SolidStroke.jsglExtend(jsgl.stroke.AbstractStroke);jsgl.stroke.SolidStroke.prototype.applyToSvgElement=function(svgElement){if(this.enabled){svgElement.style.setProperty("stroke",this.color,null);svgElement.style.setProperty("stroke-width",this.weight+"px",null);svgElement.style.setProperty("stroke-opacity",this.opacity,null);this.dashStyle.applyToSvgElement(svgElement,this.weight);this.endcapType.applyToSvgElement(svgElement);this.joinStyle.applyToSvgElement(svgElement)}else{svgElement.style.setProperty("stroke","none",null)}};jsgl.stroke.SolidStroke.prototype.applyToVmlStrokeElement=function(strokeElement){if(this.enabled){strokeElement.color=this.color;strokeElement.weight=this.weight+"px";strokeElement.opacity=this.opacity;strokeElement.on=true;this.dashStyle.applyToVmlStrokeElement(strokeElement);this.endcapType.applyToVmlStrokeElement(strokeElement);this.joinStyle.applyToVmlStrokeElement(strokeElement)}else{strokeElement.on=false}};jsgl.stroke.SolidStroke.prototype.getWeight=function(){return this.weight};jsgl.stroke.SolidStroke.prototype.setWeight=function(newWeight){this.weight=newWeight;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getColor=function(){return this.color};jsgl.stroke.SolidStroke.prototype.setColor=function(newColor){this.color=newColor;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getOpacity=function(){return this.opacity};jsgl.stroke.SolidStroke.prototype.setOpacity=function(newOpacity){this.opacity=newOpacity;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getDashStyle=function(){return this.dashStyle};jsgl.stroke.SolidStroke.prototype.setDashStyle=function(dashStyle){this.dashStyle=dashStyle;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getEndcapType=function(){return this.endcapType};jsgl.stroke.SolidStroke.prototype.setEndcapType=function(endcapType){this.endcapType=endcapType;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getJoinStyle=function(){return this.joinStyle};jsgl.stroke.SolidStroke.prototype.setJoinStyle=function(joinStyle){this.joinStyle=joinStyle;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getEnabled=function(){return this.enabled};jsgl.stroke.SolidStroke.prototype.isEnabled=jsgl.stroke.SolidStroke.prototype.getEnabled;jsgl.stroke.SolidStroke.prototype.isEnabled=function(){return this.enabled};jsgl.stroke.SolidStroke.prototype.setEnabled=function(enabled){this.enabled=enabled;this.onChangeRaiser.raiseEvent()};jsgl.stroke.AbstractEndcapType=function(){};jsgl.stroke.AbstractEndcapType.prototype.applyToSvgElement=function(svgElement){throw"not implemented"};jsgl.stroke.AbstractEndcapType.prototype.applyToVmlStrokeElement=function(strokeElement){throw"not implemented"};jsgl.stroke.FlatEndcapType=function(){};jsgl.stroke.FlatEndcapType.jsglExtend(jsgl.stroke.AbstractEndcapType);jsgl.stroke.FlatEndcapType.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-linecap","butt",null)};jsgl.stroke.FlatEndcapType.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.endcap="flat"};jsgl.stroke.FlatEndcapType.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.RoundEndcapType=function(){};jsgl.stroke.RoundEndcapType.jsglExtend(jsgl.stroke.AbstractEndcapType);jsgl.stroke.RoundEndcapType.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-linecap","round",null)};jsgl.stroke.RoundEndcapType.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.endcap="round"};jsgl.stroke.RoundEndcapType.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.SquareEndcapType=function(){};jsgl.stroke.SquareEndcapType.jsglExtend(jsgl.stroke.AbstractEndcapType);jsgl.stroke.SquareEndcapType.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-linecap","square",null)};jsgl.stroke.SquareEndcapType.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.endcap="square"};jsgl.stroke.SquareEndcapType.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.AbstractJoinStyle=function(){this.onChangeRaiser=new EventRaiser()};jsgl.stroke.AbstractJoinStyle.prototype.applyToSvgElement=function(svgElement){throw"not implemented"};jsgl.stroke.AbstractJoinStyle.prototype.applyToVmlStrokeElement=function(strokeElement){throw"not implemented"};jsgl.stroke.AbstractJoinStyle.prototype.containsPointStrokeTest=function(point,vertexLocation,orientationA,orientationB,strokeWidth){return false};jsgl.stroke.AbstractJoinStyle.prototype.registerChangeListener=function(listener){this.onChangeRaiser.registerListener(listener)};jsgl.stroke.AbstractJoinStyle.prototype.unregisterChangeListener=function(listener){this.onChangeRaiser.unregisterListener(listener)};jsgl.stroke.BevelJoinStyle=function(){};jsgl.stroke.BevelJoinStyle.jsglExtend(jsgl.stroke.AbstractJoinStyle);jsgl.stroke.BevelJoinStyle.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-linejoin","bevel",null)};jsgl.stroke.BevelJoinStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.joinstyle="bevel"};jsgl.stroke.BevelJoinStyle.prototype.containsPointStrokeTest=function(point,vertexLocation,orientationA,orientationB,strokeWidth){var u1=Math.cos(orientationA+Math.PI/2)*strokeWidth/2,u2=Math.sin(orientationA+Math.PI/2)*strokeWidth/2,v1=Math.cos(orientationB-Math.PI/2)*strokeWidth/2,v2=Math.sin(orientationB-Math.PI/2)*strokeWidth/2,w1=point.X-vertexLocation.X,w2=point.Y-vertexLocation.Y;var t=(u1*w2-u2*w1)/(u1*v2-u2*v1),s=(w1-v1*t)/u1;return(s>=0)&&(t>=0)&&(s+t<=1)};jsgl.stroke.BevelJoinStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.MiterJoinStyle=function(miterLimit){this.miterLimit=miterLimit};jsgl.stroke.MiterJoinStyle.jsglExtend(jsgl.stroke.AbstractJoinStyle);jsgl.stroke.MiterJoinStyle.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-linejoin","miter",null);svgElement.style.setProperty("stroke-miterlimit",this.miterLimit,null)};jsgl.stroke.MiterJoinStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.joinstyle="miter";strokeElement.miterlimit=this.miterLimit};jsgl.stroke.MiterJoinStyle.prototype.getMiterLimit=function(){return this.miterLimit};jsgl.stroke.MiterJoinStyle.prototype.setMiterLimit=function(miterLimit){this.miterLimit=miterLimit;this.onChangeRaiser.raiseEvent()};jsgl.stroke.RoundJoinStyle=function(){};jsgl.stroke.RoundJoinStyle.jsglExtend(jsgl.stroke.AbstractJoinStyle);jsgl.stroke.RoundJoinStyle.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-linejoin","round",null)};jsgl.stroke.RoundJoinStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.joinstyle="round"};jsgl.stroke.RoundJoinStyle.prototype.containsPointStrokeTest=function(point,vertexLocation,orientationA,orientationB,strokeWidth){return jsgl.Vector2D.getDistance(point,vertexLocation)<=strokeWidth/2};jsgl.stroke.RoundJoinStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.AbstractDashStyle=function(){};jsgl.stroke.AbstractDashStyle.prototype.getDashArray=function(){throw"not implemented"};jsgl.stroke.AbstractDashStyle.prototype.applyToSvgElement=function(svgElement,strokeWeight){var dashArray=this.getDashArray();for(var i=0;i<dashArray.length;i++){dashArray[i]*=strokeWeight;if(!dashArray[i]){dashArray[i]+=0.01}}svgElement.style.setProperty("stroke-dasharray",dashArray.join(),null)};jsgl.stroke.AbstractDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){throw"not implemented"};jsgl.stroke.DashDashStyle=function(){};jsgl.stroke.DashDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.DashDashStyle.prototype.getDashArray=function(){return[3,4]};jsgl.stroke.DashDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="dash"};jsgl.stroke.DashDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.DashDotDashStyle=function(){};jsgl.stroke.DashDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.DashDotDashStyle.prototype.getDashArray=function(){return[3,4,0,4]};jsgl.stroke.DashDotDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="dashdot"};jsgl.stroke.DashDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.DotDashStyle=function(){};jsgl.stroke.DotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.DotDashStyle.prototype.getDashArray=function(){return[0,4]};jsgl.stroke.DotDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="dot"};jsgl.stroke.DotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.LongDashDashStyle=function(){};jsgl.stroke.LongDashDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.LongDashDashStyle.prototype.getDashArray=function(){return[7,4]};jsgl.stroke.LongDashDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="longdash"};jsgl.stroke.LongDashDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.LongDashDotDashStyle=function(){};jsgl.stroke.LongDashDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.LongDashDotDashStyle.prototype.getDashArray=function(){return[7,4,0,4]};jsgl.stroke.LongDashDotDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="longdashdot"};jsgl.stroke.LongDashDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.LongDashDotDotDashStyle=function(){};jsgl.stroke.LongDashDotDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.LongDashDotDotDashStyle.prototype.getDashArray=function(){return[7,4,0,4,0,4]};jsgl.stroke.LongDashDotDotDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="longdashdotdot"};jsgl.stroke.LongDashDotDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.ShortDashDotDashStyle=function(){};jsgl.stroke.ShortDashDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.ShortDashDotDashStyle.prototype.getDashArray=function(){return[2,2,0,2]};jsgl.stroke.ShortDashDotDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="shortdashdot"};jsgl.stroke.ShortDashDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.SolidDashStyle=function(){};jsgl.stroke.SolidDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.SolidDashStyle.prototype.getDashArray=function(){return[Number.POSITIVE_INFINITY]};jsgl.stroke.SolidDashStyle.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("stroke-dasharray","none",null)};jsgl.stroke.SolidDashStyle.prototype.applyToVmlStrokeElement=function(strokeElement){strokeElement.dashstyle="solid"};jsgl.stroke.SolidDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.fill.AbstractFill=function(){this.onChangeRaiser=new jsgl.util.EventRaiser()};jsgl.fill.AbstractFill.prototype.applyToSvgElement=function(svgElement){throw"not implemented"};jsgl.fill.AbstractFill.prototype.applyToVmlFillElement=function(fillElement){throw"not implemented"};jsgl.fill.AbstractFill.prototype.registerChangeListener=function(listener){this.onChangeRaiser.registerListener(listener)};jsgl.fill.AbstractFill.prototype.unregisterChangeListener=function(listener){this.onChangeRaiser.unregisterListener(listener)};jsgl.fill.DisabledFill=function(){jsgl.fill.AbstractFill.call(this)};jsgl.fill.DisabledFill.jsglExtend(jsgl.fill.AbstractFill);jsgl.fill.DISABLED=new jsgl.fill.DisabledFill();jsgl.fill.DisabledFill.prototype.applyToSvgElement=function(svgElement){svgElement.style.setProperty("fill","none",null)};jsgl.fill.DisabledFill.prototype.applyToVmlFillElement=function(fillElement){fillElement.on=false};jsgl.fill.SolidFill=function(color,opacity,enabled){jsgl.fill.AbstractFill.call(this);this.color=color||"white";this.opacity=typeof(opacity)!="undefined"?opacity:1;this.enabled=typeof(enabled)!="undefined"?!!enabled:true};jsgl.fill.SolidFill.jsglExtend(jsgl.fill.AbstractFill);jsgl.fill.SolidFill.prototype.applyToSvgElement=function(svgElement){if(this.enabled){svgElement.style.setProperty("fill",this.color,null);svgElement.style.setProperty("fill-opacity",this.opacity,null)}else{svgElement.style.setProperty("fill","none",null)}};jsgl.fill.SolidFill.prototype.applyToVmlFillElement=function(fillElement){if(this.enabled){fillElement.type="solid";fillElement.color=this.color;fillElement.opacity=this.opacity;fillElement.on=true}else{fillElement.on=false}};jsgl.fill.SolidFill.prototype.getColor=function(){return this.color};jsgl.fill.SolidFill.prototype.setColor=function(newColor){this.color=newColor;this.onChangeRaiser.raiseEvent()};jsgl.fill.SolidFill.prototype.getEnabled=function(){return this.enabled};jsgl.fill.SolidFill.prototype.isEnabled=jsgl.fill.SolidFill.prototype.getEnabled;jsgl.fill.SolidFill.prototype.setEnabled=function(enabled){this.enabled=enabled;this.onChangeRaiser.raiseEvent()};jsgl.fill.SolidFill.prototype.getOpacity=function(){return this.opacity};jsgl.fill.SolidFill.prototype.setOpacity=function(newOpacity){this.opacity=newOpacity;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractElement=function(panel){this.panel=panel;this.container=null;this.age=0;this.zIndex=0;this.zIndexChangeRaiser=new jsgl.util.EventRaiser();this.cursor=jsgl.Cursor.INHERIT;this.uid=jsgl.elements.AbstractElement.uidCounter++;this.onChangeRaiser=new jsgl.util.EventRaiser();this.mouseMoveRaiser=new jsgl.util.EventRaiser();this.mouseDownRaiser=new jsgl.util.EventRaiser();this.mouseUpRaiser=new jsgl.util.EventRaiser();this.mouseOverRaiser=new jsgl.util.EventRaiser();this.mouseOutRaiser=new jsgl.util.EventRaiser();this.clickRaiser=new jsgl.util.EventRaiser();this.dblClickRaiser=new jsgl.util.EventRaiser();this.contextMenuRaiser=new jsgl.util.EventRaiser()};jsgl.elements.AbstractElement.uidCounter=0;jsgl.elements.AbstractElement.prototype.getUid=function(){return this.uid};jsgl.elements.AbstractElement.prototype.getPanel=function(){return this.panel};jsgl.elements.AbstractElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.AbstractElement.prototype.setContainer=function(container){this.container=container};jsgl.elements.AbstractElement.prototype.getContainer=function(){return this.container};jsgl.elements.AbstractElement.prototype.getAge=function(){return this.age};jsgl.elements.AbstractElement.prototype.setAge=function(newAge){this.age=newAge};jsgl.elements.AbstractElement.prototype.addMouseMoveListener=function(listener){this.mouseMoveRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeMouseMoveListener=function(listener){this.mouseMoveRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseMouseMove=function(eventArgs){this.mouseMoveRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addMouseDownListener=function(listener){this.mouseDownRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeMouseDownListener=function(listener){this.mouseDownRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseMouseDown=function(eventArgs){this.mouseDownRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addMouseUpListener=function(listener){this.mouseUpRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeMouseUpListener=function(listener){this.mouseUpRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseMouseUp=function(eventArgs){this.mouseUpRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addMouseOverListener=function(listener){this.mouseOverRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeMouseOverListener=function(listener){this.mouseOverRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseMouseOver=function(eventArgs){this.mouseOverRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addMouseOutListener=function(listener){this.mouseOutRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeMouseOutListener=function(listener){this.mouseOutRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseMouseOut=function(eventArgs){this.mouseOutRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addClickListener=function(listener){this.clickRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeClickListener=function(listener){this.clickRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseClick=function(eventArgs){this.clickRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addDoubleClickListener=function(listener){this.dblClickRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeDoubleClickListener=function(listener){this.dblClickRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseDoubleClick=function(eventArgs){this.dblClickRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addContextMenuListener=function(listener){this.contextMenuRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeContextMenuListener=function(listener){this.contextMenuRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.raiseContextMenu=function(eventArgs){this.contextMenuRaiser.raiseEvent(eventArgs)};jsgl.elements.AbstractElement.prototype.addChangeListener=function(listener){this.onChangeRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeChangeListener=function(listener){this.onChangeRaiser.unregisterListener(listener)};jsgl.elements.AbstractElement.prototype.setZIndex=function(zIndex){this.zIndex=Number(zIndex);this.zIndexChangeRaiser.raiseEvent();this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractElement.prototype.getZIndex=function(){return this.zIndex};jsgl.elements.AbstractElement.prototype.setCursor=function(cursor){this.cursor=cursor;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractElement.prototype.getCursor=function(){return this.cursor};jsgl.elements.AbstractElement.prototype.addZIndexChangeListener=function(listener){this.zIndexChangeRaiser.registerListener(listener)};jsgl.elements.AbstractElement.prototype.removeZIndexChangeListener=function(listener){this.zIndexChangeRaiser.unregisterListener(listener)};jsgl.elements.AbstractDomPresenter=function(){this.graphicsElement=null;this.refreshTimer=null};jsgl.elements.AbstractDomPresenter.prototype.getGraphicsElement=function(){return this.graphicsElement};jsgl.elements.AbstractDomPresenter.prototype.setGraphicsElement=function(element){this.graphicsElement=element;this.getXmlElement().jsglElement=element;this.graphicsElement.addChangeListener(jsgl.util.delegate(this,this.invalidate))};jsgl.elements.AbstractDomPresenter.prototype.getXmlElement=function(){throw"getXmlElement(): not implemented"};jsgl.elements.AbstractDomPresenter.prototype.update=function(){this.getXmlElement().style.zIndex=this.getGraphicsElement().getZIndex();this.getXmlElement().style.cursor=this.getGraphicsElement().getCursor().asCSS};jsgl.elements.AbstractDomPresenter.prototype.invalidate=function(){if(!jsgl.IMMEDIATE_UPDATE==true){if(this.refreshTimer!=null){window.clearTimeout(this.refreshTimer)}this.refreshTimer=window.setTimeout(jsgl.util.delegate(this,this.update),0)}else{this.update()}};jsgl.elements.AbstractDomPresenter.prototype.attachMouseHandlers=function(element){element.onclick=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseClick(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.CLICK))});element.oncontextmenu=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseContextMenu(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.CONTEXTMENU))});element.ondblclick=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseDoubleClick(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.DOUBLE_CLICK))});element.onmousedown=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseMouseDown(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.DOWN))});element.onmouseup=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseMouseUp(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.UP))});element.onmousemove=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseMouseMove(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.MOVE))});element.onmouseover=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseMouseOver(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.OVER))});element.onmouseout=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.graphicsElement.raiseMouseOut(jsgl.MouseEvent.fromJsglElement(e,this.graphicsElement,jsgl.MouseEvent.OUT))})};jsgl.elements.DomSorter=function(domRoot){this.domRoot=domRoot;this.idToPosition={};this.posToElement={};this.idToZICL={};this.numElements=0;this.ageCounter=0};jsgl.elements.DomSorter.prototype.add=function(element){element.setAge(this.ageCounter++);this.domRoot.appendChild(element.getDomPresenter().getXmlElement());this.idToPosition[element.getUid()]=this.numElements;this.posToElement[this.numElements]=element;this.numElements++;var zicl=jsgl.util.delegate(this,function(){this.update(element)});element.addZIndexChangeListener(zicl);this.idToZICL[element.getUid()]=zicl;this.update(element)};jsgl.elements.DomSorter.prototype.remove=function(element){var uid=element.getUid();element.setAge(-1);var position=this.idToPosition[uid];for(var i=position;i<this.numElements-1;i++){this.posToElement[i]=this.posToElement[i+1];this.idToPosition[this.posToElement[i+1].getUid()]--}this.idToPosition[uid]=null;this.posToElement[this.numElements-1]=null;element.removeZIndexChangeListener(this.idToZICL[uid]);this.idToZICL[uid]=null;this.domRoot.removeChild(element.getDomPresenter().getXmlElement());this.numElements--};jsgl.elements.DomSorter.prototype.update=function(element){if(!jsgl.util.BrowserInfo.supportsSvg){return}var currPos=this.idToPosition[element.getUid()];var newPos=currPos;var changed;do{changed=false;if(newPos!=this.numElements-1&&this.lessThan(this.posToElement[newPos+1],element)){newPos++;changed=true}if(newPos!=0&&this.lessThan(element,this.posToElement[newPos-1])){newPos--;changed=true}}while(changed);if(currPos==newPos){return}this.domRoot.removeChild(element.getDomPresenter().getXmlElement());if(newPos<currPos){for(var i=currPos;i>newPos;i--){this.idToPosition[this.posToElement[i-1].getUid()]++;this.posToElement[i]=this.posToElement[i-1]}this.domRoot.insertBefore(element.getDomPresenter().getXmlElement(),this.domRoot.childNodes.item(newPos))}else{for(var i=currPos;i<newPos;i++){this.idToPosition[this.posToElement[i+1].getUid()]--;this.posToElement[i]=this.posToElement[i+1]}if(newPos!=this.numElements-1){this.domRoot.insertBefore(element.getDomPresenter().getXmlElement(),this.domRoot.childNodes.item(newPos))}else{this.domRoot.appendChild(element.getDomPresenter().getXmlElement())}}this.idToPosition[element.getUid()]=newPos;this.posToElement[newPos]=element};jsgl.elements.DomSorter.prototype.lessThan=function(elementA,elementB){if(elementA.getZIndex()==elementB.getZIndex()){return elementA.getAge()<elementB.getAge()}return elementA.getZIndex()<elementB.getZIndex()};jsgl.elements.GroupElement=function(domPresenter,panel,x,y,zIndex){jsgl.elements.AbstractElement.call(this,panel,zIndex);this.location=new jsgl.Vector2D(x,y);this.elements=new jsgl.util.ArrayList();this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this);this.domSorter=new jsgl.elements.DomSorter(this.domPresenter.getXmlElement())};jsgl.elements.GroupElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.GroupElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.GroupElement.prototype.addElement=function(element){if(this.elements.contains(element)){return false}this.elements.add(element);this.domSorter.add(element);element.setContainer(this);element.getDomPresenter().update()};jsgl.elements.GroupElement.prototype.getElementAt=function(index){return this.elements.get(index)};jsgl.elements.GroupElement.prototype.getElementsCount=function(){return this.elements.getCount()};jsgl.elements.GroupElement.prototype.containsElement=function(element){return this.elements.contains(element)};jsgl.elements.GroupElement.prototype.removeElement=function(element){if(!this.elements.contains(element)){return false}this.elements.remove(element);this.domSorter.remove(element);element.setContainer(null)};jsgl.elements.GroupElement.prototype.removeAllElements=function(){this.clear()};jsgl.elements.GroupElement.prototype.clear=function(){var element;for(var i=this.elements.getCount()-1;i>=0;i--){element=this.elements.get(i);this.domSorter.remove(element);element.setContainer(null)}this.elements.clear()};jsgl.elements.GroupElement.prototype.getX=function(){return this.location.X};jsgl.elements.GroupElement.prototype.setX=function(newX){this.location.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.GroupElement.prototype.getY=function(){return this.location.Y};jsgl.elements.GroupElement.prototype.setY=function(newY){this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.GroupElement.prototype.setLocation=function(location){this.setLocationXY(location.X,location.Y)};jsgl.elements.GroupElement.prototype.setLocationXY=function(x,y){this.location=new jsgl.Vector2D(x,y);this.onChangeRaiser.raiseEvent()};jsgl.elements.GroupElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.SvgGroupDomPresenter=function(ownerDocument){this.svgGroupElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");this.attachMouseHandlers(this.svgGroupElement)};jsgl.elements.SvgGroupDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgGroupDomPresenter.prototype.getXmlElement=function(){return this.svgGroupElement};jsgl.elements.SvgGroupDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var location=this.graphicsElement.getLocation();this.svgGroupElement.setAttribute("transform","translate("+location.X+","+location.Y+")")};jsgl.elements.NonSvgGroupDomPresenter=function(ownerDocument){this.divElement=ownerDocument.createElement("div");this.divElement.style.position="absolute";this.divElement.style.width=this.divElement.style.height="0px";this.divElement.style.overflow="visible";this.attachMouseHandlers(this.divElement)};jsgl.elements.NonSvgGroupDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.NonSvgGroupDomPresenter.prototype.getXmlElement=function(){return this.divElement};jsgl.elements.NonSvgGroupDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);for(var i=0;i<this.graphicsElement.getElementsCount();i++){this.graphicsElement.getElementAt(i).getDomPresenter().update()}var location=this.graphicsElement.getLocation();this.divElement.style.left=location.X+"px";this.divElement.style.top=location.Y+"px"};jsgl.elements.CurveElement=function(domPresenter,panel){jsgl.elements.AbstractElement.call(this,panel);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.startPoint=new jsgl.Vector2D();this.control1Point=new jsgl.Vector2D();this.control2Point=new jsgl.Vector2D();this.endPoint=new jsgl.Vector2D();this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.fill.setEnabled(false);this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.CurveElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.CurveElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.CurveElement.prototype.getStartX=function(){return this.startPoint.X};jsgl.elements.CurveElement.prototype.setStartX=function(newX){this.startPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getStartY=function(){return this.startPoint.Y};jsgl.elements.CurveElement.prototype.setStartY=function(newY){this.startPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getStartPoint=function(){return jsgl.cloneObject(this.startPoint)};jsgl.elements.CurveElement.prototype.setStartPoint=function(newLocation){this.startPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setStartPointXY=function(newX,newY){this.startPoint.X=newX;this.startPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl1X=function(){return this.control1Point.X};jsgl.elements.CurveElement.prototype.setControl1X=function(newX){this.control1Point.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl1Y=function(){return this.control1Point.Y};jsgl.elements.CurveElement.prototype.setControl1Y=function(newY){this.control1Point.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl1Point=function(){return jsgl.cloneObject(this.control1Point)};jsgl.elements.CurveElement.prototype.setControl1Point=function(newLocation){this.control1Point=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setControl1PointXY=function(newX,newY){this.control1Point.X=newX;this.control1Point.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl2X=function(){return this.control2Point.X};jsgl.elements.CurveElement.prototype.setControl2X=function(newX){this.control2Point.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl2Y=function(){return this.control2Point.Y};jsgl.elements.CurveElement.prototype.setControl2Y=function(newY){this.control2Point.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl2Point=function(){return jsgl.cloneObject(this.control2Point)};jsgl.elements.CurveElement.prototype.setControl2Point=function(newLocation){this.control2Point=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setControl2PointXY=function(newX,newY){this.control2Point.X=newX;this.control2Point.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getEndX=function(){return this.endPoint.X};jsgl.elements.CurveElement.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getEndY=function(){return this.endPoint.Y};jsgl.elements.CurveElement.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.elements.CurveElement.prototype.setEndPoint=function(newLocation){this.endPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setEndPointXY=function(newX,newY){this.endPoint.X=newX;this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.CurveElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getFill=function(){return this.fill};jsgl.elements.CurveElement.prototype.setFill=function(fill){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=fill;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgCurveDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.svgPathElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","path");this.attachMouseHandlers(this.svgPathElement)};jsgl.elements.SvgCurveDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgCurveDomPresenter.prototype.getXmlElement=function(){return this.svgPathElement};jsgl.elements.SvgCurveDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.svgPathElement.setAttribute("d","M"+this.graphicsElement.getStartX()+","+this.graphicsElement.getStartY()+"C"+this.graphicsElement.getControl1X()+","+this.graphicsElement.getControl1Y()+","+this.graphicsElement.getControl2X()+","+this.graphicsElement.getControl2Y()+","+this.graphicsElement.getEndX()+","+this.graphicsElement.getEndY());this.graphicsElement.getStroke().applyToSvgElement(this.svgPathElement);this.graphicsElement.getFill().applyToSvgElement(this.svgPathElement)};jsgl.elements.VmlCurveDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.vmlCurveElement=ownerDocument.createElement("vml:curve");this.vmlCurveElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlCurveElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlCurveElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlCurveElement)};jsgl.elements.VmlCurveDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlCurveDomPresenter.prototype.getXmlElement=function(){return this.vmlCurveElement};jsgl.elements.VmlCurveDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlCurveDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlCurveDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.vmlCurveElement.from=this.graphicsElement.getStartPoint().toString();this.vmlCurveElement.control1=this.graphicsElement.getControl1Point().toString();this.vmlCurveElement.control2=this.graphicsElement.getControl2Point().toString();this.vmlCurveElement.to=this.graphicsElement.getEndPoint().toString();this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.CircleElement=function(domPresenter,panel){jsgl.elements.AbstractElement.call(this,panel);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.centerLocation=new jsgl.Vector2D();this.radius=0;this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.CircleElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.CircleElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.CircleElement.prototype.getCenterX=function(){return this.centerLocation.X};jsgl.elements.CircleElement.prototype.setCenterX=function(x){this.centerLocation.X=x;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getCenterY=function(){return this.centerLocation.Y};jsgl.elements.CircleElement.prototype.setCenterY=function(y){this.centerLocation.Y=y;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getCenterLocation=function(){return jsgl.cloneObject(this.centerLocation)};jsgl.elements.CircleElement.prototype.setCenterLocation=function(location){this.centerLocation=jsgl.cloneObject(location);this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.setCenterLocationXY=function(x,y){this.centerLocation.X=x;this.centerLocation.Y=y;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getRadius=function(){return this.radius};jsgl.elements.CircleElement.prototype.setRadius=function(radius){this.radius=radius;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.CircleElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getFill=function(){return this.fill};jsgl.elements.CircleElement.prototype.setFill=function(fill){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=fill;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgCircleDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.svgCircleElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","circle");this.attachMouseHandlers(this.svgCircleElement)};jsgl.elements.SvgCircleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgCircleDomPresenter.prototype.getXmlElement=function(){return this.svgCircleElement};jsgl.elements.SvgCircleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var location=this.graphicsElement.getCenterLocation(),radius=this.graphicsElement.getRadius();this.svgCircleElement.setAttribute("cx",location.X);this.svgCircleElement.setAttribute("cy",location.Y);this.svgCircleElement.setAttribute("r",radius);this.graphicsElement.getStroke().applyToSvgElement(this.svgCircleElement);this.graphicsElement.getFill().applyToSvgElement(this.svgCircleElement)};jsgl.elements.VmlCircleDomPresenter=function(ownerDocument){this.vmlElement=ownerDocument.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlCircleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlCircleDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlCircleDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlCircleDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlCircleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var location=this.graphicsElement.getCenterLocation(),radius=this.graphicsElement.getRadius();this.vmlElement.style.left=(location.X-radius)+"px";this.vmlElement.style.top=(location.Y-radius)+"px";this.vmlElement.style.width=this.vmlElement.style.height=2*radius+"px";this.vmlElement.coordsize=20*radius+" "+20*radius;this.vmlElement.path="m"+Math.round(20*radius)+" "+Math.round(10*radius)+"qy"+Math.round(10*radius)+" "+Math.round(20*radius)+"qx0 "+Math.round(10*radius)+"qy"+Math.round(10*radius)+" 0qx"+Math.round(20*radius)+" "+Math.round(10*radius)+"xe";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.EllipseElement=function(domPresenter,panel){jsgl.elements.AbstractElement.call(this,panel);this.centerLocation=new jsgl.Vector2D();this.size=new jsgl.Vector2D();this.rotation=0;this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.EllipseElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.EllipseElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.EllipseElement.prototype.getCenterX=function(){return this.centerLocation.X};jsgl.elements.EllipseElement.prototype.setCenterX=function(newX){this.centerLocation.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getCenterY=function(){return this.centerLocation.Y};jsgl.elements.EllipseElement.prototype.setCenterY=function(newY){this.centerLocation.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getCenterLocation=function(){return jsgl.cloneObject(this.centerLocation)};jsgl.elements.EllipseElement.prototype.setCenterLocation=function(location){this.centerLocation=jsgl.cloneObject(location);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.setCenterLocationXY=function(x,y){this.centerLocation.X=x;this.centerLocation.Y=y;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getWidth=function(){return this.size.X};jsgl.elements.EllipseElement.prototype.setWidth=function(width){this.size.X=width;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getHeight=function(){return this.size.Y};jsgl.elements.EllipseElement.prototype.setHeight=function(height){this.size.Y=height;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getSize=function(){return jsgl.cloneObject(this.size)};jsgl.elements.EllipseElement.prototype.setSize=function(size){this.size=jsgl.cloneObject(size);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.setSizeWH=function(newWidth,newHeight){this.size=new jsgl.Vector2D(newWidth,newHeight);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getRotation=function(){return this.rotation};jsgl.elements.EllipseElement.prototype.setRotation=function(rotation){this.rotation=rotation;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.EllipseElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getFill=function(){return this.fill};jsgl.elements.EllipseElement.prototype.setFill=function(fill){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=fill;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgEllipseDomPresenter=function(ownerDocument){this.svgEllipseElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","ellipse");this.attachMouseHandlers(this.svgEllipseElement)};jsgl.elements.SvgEllipseDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgEllipseDomPresenter.prototype.getXmlElement=function(){return this.svgEllipseElement};jsgl.elements.SvgEllipseDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var location=this.graphicsElement.getCenterLocation();this.svgEllipseElement.setAttribute("cx",location.X);this.svgEllipseElement.setAttribute("cy",location.Y);this.svgEllipseElement.setAttribute("rx",this.graphicsElement.getWidth()/2);this.svgEllipseElement.setAttribute("ry",this.graphicsElement.getHeight()/2);this.svgEllipseElement.setAttribute("transform","rotate("+this.graphicsElement.getRotation()+" "+location.X+" "+location.Y+")");this.graphicsElement.getStroke().applyToSvgElement(this.svgEllipseElement);this.graphicsElement.getFill().applyToSvgElement(this.svgEllipseElement)};jsgl.elements.VmlEllipseDomPresenter=function(ownerDocument){this.vmlElement=ownerDocument.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlEllipseDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlEllipseDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlEllipseDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlEllipseDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlEllipseDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var location=this.graphicsElement.getCenterLocation(),size=this.graphicsElement.getSize();this.vmlElement.style.left=(location.X-size.X/2);this.vmlElement.style.top=(location.Y-size.Y/2);this.vmlElement.style.width=size.X+"px";this.vmlElement.style.height=size.Y+"px";this.vmlElement.style.rotation=this.graphicsElement.getRotation();this.vmlElement.coordsize=10*size.X+" "+10*size.Y;this.vmlElement.path="m"+Math.round(10*size.X)+" "+Math.round(5*size.Y)+"qy"+Math.round(5*size.X)+" "+Math.round(10*size.Y)+"qx0 "+Math.round(5*size.Y)+"qy"+Math.round(5*size.X)+" 0qx"+Math.round(10*size.X)+" "+Math.round(5*size.Y)+"xe";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.RectangleElement=function(domPresenter,panel){jsgl.elements.AbstractElement.call(this,panel);this.location=new jsgl.Vector2D();this.size=new jsgl.Vector2D();this.horizontalAnchor=jsgl.HorizontalAnchor.LEFT;this.verticalAnchor=jsgl.VerticalAnchor.TOP;this.rotation=0;this.roundingRadii=new jsgl.Vector2D();this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.RectangleElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.RectangleElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.RectangleElement.prototype.getX=function(){return this.location.X};jsgl.elements.RectangleElement.prototype.setX=function(newX){this.location.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getY=function(){return this.location.Y};jsgl.elements.RectangleElement.prototype.setY=function(newY){this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.RectangleElement.prototype.setLocation=function(newLocation){this.location=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.setLocationXY=function(newX,newY){this.location.X=newX;this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getWidth=function(){return this.size.X};jsgl.elements.RectangleElement.prototype.setWidth=function(newWidth){this.size.X=newWidth;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getHeight=function(){return this.size.Y};jsgl.elements.RectangleElement.prototype.setHeight=function(newHeight){this.size.Y=newHeight;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getSize=function(){return jsgl.cloneObject(this.size)};jsgl.elements.RectangleElement.prototype.setSize=function(newSize){this.size=jsgl.cloneObject(newSize);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.setSizeWH=function(newW,newH){this.size.X=newW;this.size.Y=newH;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getRotation=function(){return this.rotation};jsgl.elements.RectangleElement.prototype.setRotation=function(rotation){this.rotation=rotation;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getHorizontalAnchor=function(){return this.horizontalAnchor};jsgl.elements.RectangleElement.prototype.setHorizontalAnchor=function(horAnchor){this.horizontalAnchor=horAnchor;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getVerticalAnchor=function(){return this.verticalAnchor};jsgl.elements.RectangleElement.prototype.setVerticalAnchor=function(vertAnchor){this.verticalAnchor=vertAnchor;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getXRadius=function(){return this.roundingRadii.X};jsgl.elements.RectangleElement.prototype.setXRadius=function(newXRadius){this.roundingRadii.X=newXRadius;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getYRadius=function(){return this.roundingRadii.Y};jsgl.elements.RectangleElement.prototype.setYRadius=function(newYRadius){this.roundingRadii.Y=newYRadius;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getRadii=function(){return jsgl.cloneObject(this.roundingRadii)};jsgl.elements.RectangleElement.prototype.setRadii=function(newRadii){this.roundingRadii=jsgl.cloneObject(newRadii);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.setRadiiXY=function(newXRadius,newYRadius){this.roundingRadii.X=newXRadius;this.roundingRadii.Y=newYRadius;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.RectangleElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getFill=function(){return this.fill};jsgl.elements.RectangleElement.prototype.setFill=function(fill){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=fill;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgRectangleDomPresenter=function(ownerDocument){this.svgRectElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","rect");this.attachMouseHandlers(this.svgRectElement)};jsgl.elements.SvgRectangleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgRectangleDomPresenter.prototype.getXmlElement=function(){return this.svgRectElement};jsgl.elements.SvgRectangleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var location=this.graphicsElement.getLocation(),size=this.graphicsElement.getSize(),radii=this.graphicsElement.getRadii();var x,y;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:x=location.X;break;case jsgl.HorizontalAnchor.CENTER:x=location.X-size.X/2;break;case jsgl.HorizontalAnchor.RIGHT:x=location.X-size.X;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:y=location.Y;break;case jsgl.VerticalAnchor.MIDDLE:y=location.Y-size.Y/2;break;case jsgl.VerticalAnchor.BOTTOM:y=location.Y-size.Y;break}this.svgRectElement.setAttribute("x",x);this.svgRectElement.setAttribute("y",y);this.svgRectElement.setAttribute("width",size.X);this.svgRectElement.setAttribute("height",size.Y);this.svgRectElement.setAttribute("rx",radii.X);this.svgRectElement.setAttribute("ry",radii.Y);this.svgRectElement.setAttribute("transform","rotate("+this.graphicsElement.getRotation()+","+location.X+","+location.Y+")");this.graphicsElement.getStroke().applyToSvgElement(this.svgRectElement);this.graphicsElement.getFill().applyToSvgElement(this.svgRectElement)};jsgl.elements.VmlRectangleDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.vmlShapeElement=document.createElement("vml:shape");this.vmlShapeElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlShapeElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlShapeElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlShapeElement)};jsgl.elements.VmlRectangleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlRectangleDomPresenter.prototype.getXmlElement=function(){return this.vmlShapeElement};jsgl.elements.VmlRectangleDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlRectangleDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlRectangleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var size=this.graphicsElement.getSize(),radii=new jsgl.Vector2D(Math.min(this.graphicsElement.getXRadius(),size.X/2),Math.min(this.graphicsElement.getYRadius(),size.Y/2)),location=this.graphicsElement.getLocation();var dPhi=Math.PI*this.graphicsElement.getRotation()/180;var origCX=0,origCY=0;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:origCX=location.X+size.X/2;break;case jsgl.HorizontalAnchor.CENTER:origCX=location.X;break;case jsgl.HorizontalAnchor.RIGHT:origCX=location.X-size.X/2;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:origCY=location.Y+size.Y/2;break;case jsgl.VerticalAnchor.MIDDLE:origCY=location.Y;break;case jsgl.VerticalAnchor.BOTTOM:origCY=location.Y-size.Y/2;break}var origPhi=Math.atan2(origCY-location.Y,origCX-location.X);var d=jsgl.Vector2D.getDistance(location,new jsgl.Vector2D(origCX,origCY));var trCX=location.X+Math.cos(origPhi+dPhi)*d;var trCY=location.Y+Math.sin(origPhi+dPhi)*d;this.vmlShapeElement.style.left=trCX-size.X/2;this.vmlShapeElement.style.top=trCY-size.Y/2;this.vmlShapeElement.coordsize=size.X.jsglVmlize()+" "+size.Y.jsglVmlize();this.vmlShapeElement.style.width=size.X;this.vmlShapeElement.style.height=size.Y;var rounded=radii.X>0&&radii.Y>0;var pathStr="m"+radii.X.jsglVmlize()+",0";pathStr+="l"+(size.X-(rounded?radii.X:0)).jsglVmlize()+",0";if(rounded){pathStr+="qx"+size.X.jsglVmlize()+","+radii.Y.jsglVmlize()}pathStr+="l"+size.X.jsglVmlize()+","+(size.Y-(rounded?radii.Y:0)).jsglVmlize();if(rounded){pathStr+="qy"+(size.X-radii.X).jsglVmlize()+","+size.Y.jsglVmlize()}pathStr+="l"+radii.X.jsglVmlize()+","+size.Y.jsglVmlize();if(rounded){pathStr+="qx0,"+(size.Y-radii.Y).jsglVmlize()}pathStr+="l0,"+radii.Y.jsglVmlize();if(rounded){pathStr+="qy"+radii.X.jsglVmlize()+",0"}pathStr+="ex";this.vmlShapeElement.rotation=this.graphicsElement.getRotation();this.vmlShapeElement.path=pathStr;this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.LineElement=function(domPresenter,panel,x1,y1,x2,y2,stroke,zIndex){jsgl.elements.AbstractElement.call(this,panel,zIndex);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.startPoint=new jsgl.Vector2D(x1,y1);this.endPoint=new jsgl.Vector2D(x2,y2);this.stroke=null;this.setStroke(stroke||new jsgl.stroke.SolidStroke());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.LineElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.LineElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.LineElement.prototype.getStartX=function(){return this.startPoint.X};jsgl.elements.LineElement.prototype.setStartX=function(newX){this.startPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getStartY=function(){return this.startPoint.Y};jsgl.elements.LineElement.prototype.setStartY=function(newY){this.startPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getStartPoint=function(){return jsgl.cloneObject(this.startPoint)};jsgl.elements.LineElement.prototype.setStartPoint=function(startPoint){this.setStartPointXY(startPoint.X,startPoint.Y)};jsgl.elements.LineElement.prototype.setStartPointXY=function(newX,newY){this.startPoint.X=newX;this.startPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getEndX=function(){return this.endPoint.X};jsgl.elements.LineElement.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getEndY=function(){return this.endPoint.Y};jsgl.elements.LineElement.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.elements.LineElement.prototype.setEndPoint=function(endPoint){this.setEndPointXY(endPoint.X,endPoint.Y)};jsgl.elements.LineElement.prototype.setEndPointXY=function(newX,newY){this.endPoint.X=newX;this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.LineElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgLineDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.svgLineElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","line");this.attachMouseHandlers(this.svgLineElement)};jsgl.elements.SvgLineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgLineDomPresenter.prototype.getXmlElement=function(){return this.svgLineElement};jsgl.elements.SvgLineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.svgLineElement.setAttribute("x1",this.graphicsElement.getStartX());this.svgLineElement.setAttribute("y1",this.graphicsElement.getStartY());this.svgLineElement.setAttribute("x2",this.graphicsElement.getEndX());this.svgLineElement.setAttribute("y2",this.graphicsElement.getEndY());this.graphicsElement.getStroke().applyToSvgElement(this.svgLineElement)};jsgl.elements.VmlLineDomPresenter=function(ownerDocument){this.vmlElement=ownerDocument.createElement("vml:line");this.vmlElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlLineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlLineDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlLineDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlLineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.vmlElement.from=this.graphicsElement.getStartPoint().toString();this.vmlElement.to=this.graphicsElement.getEndPoint().toString();this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement)};jsgl.elements.LabelElement=function(domPresenter,panel,x,y,text,zIndex){jsgl.elements.AbstractElement.call(this,panel,zIndex);this.location=new jsgl.Vector2D(x,y);this.text=text||"";this.fontFamily="sans-serif";this.fontSize=12;this.fontColor="black";this.underlined=false;this.overlined=false;this.struckThrough=false;this.bold=false;this.italic=false;this.horizontalAnchor=jsgl.HorizontalAnchor.LEFT;this.verticalAnchor=jsgl.VerticalAnchor.TOP;this.opacity=1;this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.LabelElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.LabelElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.LabelElement.prototype.getX=function(){return this.location.X};jsgl.elements.LabelElement.prototype.setX=function(newX){this.location.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getY=function(){return this.location.Y};jsgl.elements.LabelElement.prototype.setY=function(newY){this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.LabelElement.prototype.setLocation=function(newLocation){this.setLocationXY(newLocation.X,newLocation.Y)};jsgl.elements.LabelElement.prototype.setLocationXY=function(newX,newY){this.location.X=newX;this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getHorizontalAnchor=function(){return this.horizontalAnchor};jsgl.elements.LabelElement.prototype.setHorizontalAnchor=function(horizontalAnchor){this.horizontalAnchor=horizontalAnchor;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getVerticalAnchor=function(){return this.verticalAnchor};jsgl.elements.LabelElement.prototype.setVerticalAnchor=function(verticalAnchor){this.verticalAnchor=verticalAnchor;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getText=function(){return this.text};jsgl.elements.LabelElement.prototype.setText=function(newText){this.text=newText;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getFontFamily=function(){return this.fontFamily};jsgl.elements.LabelElement.prototype.setFontFamily=function(fontFamily){this.fontFamily=fontFamily;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getFontSize=function(){return this.fontSize};jsgl.elements.LabelElement.prototype.setFontSize=function(fontSize){this.fontSize=fontSize;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getFontColor=function(){return this.fontColor};jsgl.elements.LabelElement.prototype.setFontColor=function(fontColor){this.fontColor=fontColor;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getUnderlined=function(){return this.underlined};jsgl.elements.LabelElement.prototype.isUnderlined=jsgl.elements.LabelElement.prototype.getUnderlined;jsgl.elements.LabelElement.prototype.setUnderlined=function(underlined){this.underlined=underlined;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getOverlined=function(){return this.overlined};jsgl.elements.LabelElement.prototype.isOverlined=jsgl.elements.LabelElement.prototype.getOverlined;jsgl.elements.LabelElement.prototype.setOverlined=function(overlined){this.overlined=overlined;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getStruckThrough=function(){return this.struckThrough};jsgl.elements.LabelElement.prototype.isStruckThrough=jsgl.elements.LabelElement.prototype.getStruckThrough;jsgl.elements.LabelElement.prototype.setStruckThrough=function(struckThrough){this.struckThrough=struckThrough;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getBold=function(){return this.bold};jsgl.elements.LabelElement.prototype.isBold=jsgl.elements.LabelElement.prototype.getBold();jsgl.elements.LabelElement.prototype.setBold=function(bold){this.bold=bold;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getItalics=function(){return this.italics};jsgl.elements.LabelElement.prototype.isItalics=jsgl.elements.LabelElement.getItalics;jsgl.elements.LabelElement.prototype.setItalics=function(italics){this.italics=italics;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getOpacity=function(){return this.opacity};jsgl.elements.LabelElement.prototype.setOpacity=function(opacity){this.opacity=opacity;this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgLabelDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.svgTextElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","text");this.textNode=ownerDocument.createTextNode("");this.svgTextElement.appendChild(this.textNode);this.attachMouseHandlers(this.svgTextElement)};jsgl.elements.SvgLabelDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgLabelDomPresenter.prototype.getXmlElement=function(){return this.svgTextElement};jsgl.elements.SvgLabelDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.textNode.nodeValue=this.graphicsElement.getText();this.svgTextElement.style.setProperty("font-family",this.graphicsElement.getFontFamily(),null);this.svgTextElement.style.setProperty("fill",this.graphicsElement.getFontColor(),null);var underlined=this.graphicsElement.getUnderlined(),overlined=this.graphicsElement.getOverlined(),struckThrough=this.graphicsElement.getStruckThrough(),decorationString="";if(underlined){decorationString="underline"}if(overlined){if(decorationString){decorationString+=" overline"}else{decorationString="overline"}}if(struckThrough){if(decorationString){decorationString+=" line-through"}else{decorationString="line-through"}}this.svgTextElement.style.fontSize=this.graphicsElement.getFontSize()+"px";this.svgTextElement.style.textDecoration=decorationString;this.svgTextElement.style.fontWeight=this.graphicsElement.getBold()?"bold":"normal";this.svgTextElement.style.fontStyle=this.graphicsElement.getItalics()?"italic":"normal";this.svgTextElement.style.opacity=this.graphicsElement.getOpacity();switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:this.svgTextElement.style.setProperty("text-anchor","start",null);break;case jsgl.HorizontalAnchor.CENTER:this.svgTextElement.style.setProperty("text-anchor","middle",null);break;case jsgl.HorizontalAnchor.RIGHT:this.svgTextElement.style.setProperty("text-anchor","end",null);break}this.svgTextElement.setAttribute("x",this.graphicsElement.getX());switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:this.svgTextElement.setAttribute("dy","1em",null);break;case jsgl.VerticalAnchor.MIDDLE:this.svgTextElement.setAttribute("dy","0.6ex",null);break;case jsgl.VerticalAnchor.BOTTOM:this.svgTextElement.setAttribute("dy","0em",null);break}this.svgTextElement.setAttribute("y",this.graphicsElement.getY())};jsgl.elements.NonSvgLabelDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.spanElement=ownerDocument.createElement("nobr");this.spanTextNode=ownerDocument.createTextNode("");this.spanElement.appendChild(this.spanTextNode);this.spanElement.style.position="absolute";this.attachMouseHandlers(this.spanElement)};jsgl.elements.NonSvgLabelDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.NonSvgLabelDomPresenter.prototype.getXmlElement=function(){return this.spanElement};jsgl.elements.NonSvgLabelDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.spanTextNode.nodeValue=this.graphicsElement.getText();this.spanElement.style.fontFamily=this.graphicsElement.getFontFamily();this.spanElement.style.color=this.graphicsElement.getFontColor();var underlined=this.graphicsElement.getUnderlined(),overlined=this.graphicsElement.getOverlined(),struckThrough=this.graphicsElement.getStruckThrough(),decorationString="";if(underlined){decorationString="underline"}if(overlined){if(decorationString){decorationString+=" overline"}else{decorationString="overline"}}if(struckThrough){if(decorationString){decorationString+=" line-through"}else{decorationString="line-through"}}this.spanElement.style.fontSize=this.graphicsElement.getFontSize()+"px";this.spanElement.style.textDecoration=decorationString;this.spanElement.style.fontWeight=this.graphicsElement.getBold()?"bold":"normal";this.spanElement.style.fontStyle=this.graphicsElement.getItalics()?"italic":"normal";if(jsgl.util.BrowserInfo.isMSIElte7){if(this.graphicsElement.getOpacity()!=1){this.spanElement.style.filter="alpha(opacity="+Math.round(100*this.graphicsElement.getOpacity())+")"}else{this.spanElement.style.filter=""}}else{this.spanElement.style.opacity=this.graphicsElement.getOpacity()}switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:this.spanElement.style.left=this.graphicsElement.getX()+"px";break;case jsgl.HorizontalAnchor.RIGHT:this.spanElement.style.left=(this.graphicsElement.getX()-this.spanElement.clientWidth)+"px";break;case jsgl.HorizontalAnchor.CENTER:this.spanElement.style.left=(this.graphicsElement.getX()-this.spanElement.clientWidth/2)+"px";break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:this.spanElement.style.top=this.graphicsElement.getY()+"px";break;case jsgl.VerticalAnchor.BOTTOM:this.spanElement.style.top=(this.graphicsElement.getY()-this.spanElement.clientHeight)+"px";break;case jsgl.VerticalAnchor.MIDDLE:this.spanElement.style.top=(this.graphicsElement.getY()-this.spanElement.clientHeight/2)+"px";break}};jsgl.elements.AbstractPolygonalElement=function(panel,zIndex){jsgl.elements.AbstractElement.call(this,panel,zIndex);this.points=new jsgl.util.ArrayList()};jsgl.elements.AbstractPolygonalElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.AbstractPolygonalElement.prototype.addPoint=function(point){this.addPointXY(point.X,point.Y)};jsgl.elements.AbstractPolygonalElement.prototype.addPointXY=function(x,y){this.points.add(new jsgl.Vector2D(x,y));this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.clearPoints=function(){this.points.clear();this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.getPointAt=function(index){return jsgl.cloneObject(this.points.get(index))};jsgl.elements.AbstractPolygonalElement.prototype.setPointXYAt=function(x,y,index){var point=this.points.get(index);point.X=x;point.Y=y;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.setPointAt=function(point,index){this.setPointXYAt(point.X,point.Y,index)};jsgl.elements.AbstractPolygonalElement.prototype.getPointsCount=function(){return this.points.getCount()};jsgl.elements.AbstractPolygonalElement.prototype.insertPointAt=function(point,index){this.insertPointXYAt(point.X,point.Y,index)};jsgl.elements.AbstractPolygonalElement.prototype.insertPointXYAt=function(x,y,index){this.points.insertAt(new jsgl.Vector2D(x,y),index);this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.removePointAt=function(index){this.points.removeAt(index);this.onChangeRaiser.raiseEvent()};jsgl.elements.PolygonElement=function(domPresenter,panel,stroke,fill,zIndex){jsgl.elements.AbstractPolygonalElement.call(this,panel,zIndex);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(stroke||new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(fill||new jsgl.fill.SolidFill());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.PolygonElement.jsglExtend(jsgl.elements.AbstractPolygonalElement);jsgl.elements.PolygonElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.PolygonElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.PolygonElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.PolygonElement.prototype.getFill=function(){return this.fill};jsgl.elements.PolygonElement.prototype.setFill=function(fill){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=fill;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgPolygonDomPresenter=function(ownerDocument){this.svgPolygonElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","polygon");this.attachMouseHandlers(this.svgPolygonElement)};jsgl.elements.SvgPolygonDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgPolygonDomPresenter.prototype.getXmlElement=function(){return this.svgPolygonElement};jsgl.elements.SvgPolygonDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var pointsCount=this.graphicsElement.getPointsCount();if(pointsCount<2){this.svgPolygonElement.setAttribute("points","");return}var pointsString=(this.graphicsElement.getPointAt(0).X)+","+(this.graphicsElement.getPointAt(0).Y);for(var i=1;i<pointsCount;i++){pointsString+=" "+(this.graphicsElement.getPointAt(i).X)+","+(this.graphicsElement.getPointAt(i).Y)}this.svgPolygonElement.setAttribute("points",pointsString);this.graphicsElement.getStroke().applyToSvgElement(this.svgPolygonElement);this.graphicsElement.getFill().applyToSvgElement(this.svgPolygonElement)};jsgl.elements.VmlPolygonDomPresenter=function(ownerDocument){this.vmlElement=ownerDocument.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlPolygonDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlPolygonDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlPolygonDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlPolygonDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlPolygonDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var pointsCount=this.graphicsElement.getPointsCount();if(pointsCount<2){this.vmlElement.path="";this.vmlElement.style.width=this.vmlElement.style.height="0px";return}var currentPoint=this.graphicsElement.getPointAt(0);var left=currentPoint.X,right=currentPoint.X,top=currentPoint.Y,bottom=currentPoint.Y,pathString="M"+currentPoint.X.jsglVmlize()+" "+currentPoint.Y.jsglVmlize();for(var i=0;i<pointsCount;i++){currentPoint=this.graphicsElement.getPointAt(i);if(left>currentPoint.X){left=currentPoint.X}if(right<currentPoint.X){right=currentPoint.X}if(top>currentPoint.Y){top=currentPoint.Y}if(bottom<currentPoint.Y){bottom=currentPoint.Y}pathString+="l"+currentPoint.X.jsglVmlize()+" "+currentPoint.Y.jsglVmlize()}pathString+="xe";this.vmlElement.coordsize=(right-left).jsglVmlize()+" "+(bottom-top).jsglVmlize();this.vmlElement.setAttribute("path",pathString);this.vmlElement.style.width=(right-left)+"px";this.vmlElement.style.height=(bottom-top)+"px";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.PolylineElement=function(domPresenter,panel,stroke,zIndex){jsgl.elements.AbstractPolygonalElement.call(this,panel,zIndex);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(stroke||new jsgl.stroke.SolidStroke());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.PolylineElement.jsglExtend(jsgl.elements.AbstractPolygonalElement);jsgl.elements.PolylineElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.PolylineElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.PolylineElement.prototype.setStroke=function(stroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=stroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgPolylineDomPresenter=function(ownerDocument){this.svgPolylineElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","polyline");this.svgPolylineElement.style.setProperty("fill","none",null);this.attachMouseHandlers(this.svgPolylineElement)};jsgl.elements.SvgPolylineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgPolylineDomPresenter.prototype.getXmlElement=function(){return this.svgPolylineElement};jsgl.elements.SvgPolylineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var pointsCount=this.graphicsElement.getPointsCount();if(pointsCount==0){this.svgPolylineElement.setAttribute("points","");return}var pointsString=(this.graphicsElement.getPointAt(0).X)+","+(this.graphicsElement.getPointAt(0).Y);for(var i=1;i<pointsCount;i++){pointsString+=" "+(this.graphicsElement.getPointAt(i).X)+","+(this.graphicsElement.getPointAt(i).Y)}this.svgPolylineElement.setAttribute("points",pointsString);this.graphicsElement.getStroke().applyToSvgElement(this.svgPolylineElement)};jsgl.elements.VmlPolylineDomPresenter=function(ownerDocument){this.vmlElement=ownerDocument.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlElement.filled="no";this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlPolylineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlPolylineDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlPolylineDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlPolylineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var pointsCount=this.graphicsElement.getPointsCount();if(pointsCount<2){this.vmlElement.path="";this.vmlElement.style.width=this.vmlElement.style.height="0px";return}var currentPoint=this.graphicsElement.getPointAt(0);var left=currentPoint.X,right=currentPoint.X,top=currentPoint.Y,bottom=currentPoint.Y,pathString="m"+Math.round(currentPoint.X)+" "+Math.round(currentPoint.Y);for(var i=0;i<pointsCount;i++){currentPoint=this.graphicsElement.getPointAt(i);if(left>currentPoint.X){left=currentPoint.X}if(right<currentPoint.X){right=currentPoint.X}if(top>currentPoint.Y){top=currentPoint.Y}if(bottom<currentPoint.Y){bottom=currentPoint.Y}pathString+="l"+Math.round(currentPoint.X)+","+Math.round(currentPoint.Y)}pathString+="e";this.vmlElement.setAttribute("path",pathString);this.vmlElement.coordsize=(right-left)*100+" "+(bottom-top)*100;this.vmlElement.style.width=(right-left)*100+"px";this.vmlElement.style.height=(bottom-top)*100+"px";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement)};jsgl.elements.ImageElement=function(domPresenter,panel){jsgl.elements.AbstractElement.call(this,panel);this.location=new jsgl.Vector2D();this.size=new jsgl.Vector2D();this.horizontalAnchor=jsgl.HorizontalAnchor.LEFT;this.verticalAnchor=jsgl.VerticalAnchor.TOP;this.autosizeX=true;this.autosizeY=true;this.rotation=0;this.opacity=1;this.url="";this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.stroke.setEnabled(false);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.ImageElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.ImageElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.ImageElement.prototype.getX=function(){return this.location.X};jsgl.elements.ImageElement.prototype.setX=function(newX){this.location.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getY=function(){return this.location.Y};jsgl.elements.ImageElement.prototype.setY=function(newY){this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.ImageElement.prototype.setLocation=function(newLocation){this.setlLcationXY(newLocation.X,newLocation.Y)};jsgl.elements.ImageElement.prototype.setLocationXY=function(newX,newY){this.location.X=newX;this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getWidth=function(){return this.autosizeX?this.domPresenter.getImageSize().X:this.size.X};jsgl.elements.ImageElement.prototype.setWidth=function(newWidth){this.autosizeX=false;this.size.X=newWidth;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getHeight=function(){return this.autosizeY?this.domPresenter.getImageSize().Y:this.size.Y};jsgl.elements.ImageElement.prototype.setHeight=function(newHeight){this.autosizeY=false;this.size.Y=newHeight;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getSize=function(){return new jsgl.Vector2D(this.autosizeX?this.domPresenter.getImageSize().X:this.size.X,this.autosizeY?this.domPresenter.getImageSize().Y:this.size.Y)};jsgl.elements.ImageElement.prototype.setSize=function(newSize){this.setSizeWH(newSize.X,newSize.Y)};jsgl.elements.ImageElement.prototype.setSizeWH=function(newW,newH){this.autosizeX=false;this.autosizeY=false;this.size.X=newW;this.size.Y=newH;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getOpacity=function(){return this.opacity};jsgl.elements.ImageElement.prototype.setOpacity=function(opacity){this.opacity=opacity;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getRotation=function(){return this.rotation};jsgl.elements.ImageElement.prototype.setRotation=function(rotation){this.rotation=rotation;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getHorizontalAnchor=function(){return this.horizontalAnchor};jsgl.elements.ImageElement.prototype.setHorizontalAnchor=function(horAnchor){this.horizontalAnchor=horAnchor;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getVerticalAnchor=function(){return this.verticalAnchor};jsgl.elements.ImageElement.prototype.setVerticalAnchor=function(vertAnchor){this.verticalAnchor=vertAnchor;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getUrl=function(){return this.url};jsgl.elements.ImageElement.prototype.setUrl=function(url){this.url=url;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.ImageElement.prototype.setStroke=function(newStroke){this.stroke=newStroke;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractImageDomPresenter=function(){this.loadedUrl=null;this.isLoaded=false;this.image=null};jsgl.elements.AbstractImageDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.AbstractImageDomPresenter.prototype.loadUrl=function(url){if(this.loadedUrl!=url){this.loadedUrl=url;this.imageLoaded=false;this.image=new Image();this.image.src=url;this.image.onload=jsgl.util.delegate(this,function(){this.isLoaded=true})}};jsgl.elements.AbstractImageDomPresenter.prototype.getImageSize=function(){if(this.isLoaded){return new jsgl.Vector2D(this.image.width,this.image.height)}return new jsgl.Vector2D()};jsgl.elements.SvgImageDomPresenter=function(ownerDocument){jsgl.elements.AbstractImageDomPresenter.call(this);this.svgGElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");this.svgImageElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","image");this.svgImageElement.setAttribute("preserveAspectRatio","none");this.svgGElement.appendChild(this.svgImageElement);this.svgRectElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","rect");this.svgRectElement.style.setProperty("fill","none",null);this.svgGElement.appendChild(this.svgRectElement);this.attachMouseHandlers(this.svgGElement)};jsgl.elements.SvgImageDomPresenter.jsglExtend(jsgl.elements.AbstractImageDomPresenter);jsgl.elements.SvgImageDomPresenter.prototype.getXmlElement=function(){return this.svgGElement};jsgl.elements.SvgImageDomPresenter.prototype.update=function(){this.loadUrl(this.graphicsElement.getUrl());if(!this.isLoaded){window.setTimeout(jsgl.util.delegate(this,this.update),50);return}jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var size=this.graphicsElement.getSize(),location=this.graphicsElement.getLocation();var x=0,y=0;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:x=location.X;break;case jsgl.HorizontalAnchor.CENTER:x=location.X-size.X/2;break;case jsgl.HorizontalAnchor.RIGHT:x=location.X-size.X;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:y=location.Y;break;case jsgl.VerticalAnchor.MIDDLE:y=location.Y-size.Y/2;break;case jsgl.VerticalAnchor.BOTTOM:y=location.Y-size.Y;break}this.svgImageElement.setAttribute("x",x);this.svgRectElement.setAttribute("x",x);this.svgImageElement.setAttribute("y",y);this.svgRectElement.setAttribute("y",y);this.svgImageElement.setAttribute("width",size.X);this.svgRectElement.setAttribute("width",size.X);this.svgImageElement.setAttribute("height",size.Y);this.svgRectElement.setAttribute("height",size.Y);this.svgImageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",this.graphicsElement.getUrl());this.svgGElement.setAttribute("transform","rotate("+this.graphicsElement.getRotation()+","+location.X+","+location.Y+")");this.svgImageElement.style.opacity=this.graphicsElement.getOpacity();this.graphicsElement.getStroke().applyToSvgElement(this.svgRectElement)};jsgl.elements.VmlImageDomPresenter=function(ownerDocument){jsgl.elements.AbstractImageDomPresenter.call(this);this.vmlRectElement=ownerDocument.createElement("vml:rect");this.vmlRectElement.style.position="absolute";this.vmlRectElement.stroked=false;this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlRectElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlFillElement.type="frame";this.vmlFillElement.rotate=true;this.vmlRectElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlRectElement)};jsgl.elements.VmlImageDomPresenter.jsglExtend(jsgl.elements.AbstractImageDomPresenter);jsgl.elements.VmlImageDomPresenter.prototype.getXmlElement=function(){return this.vmlRectElement};jsgl.elements.VmlImageDomPresenter.prototype.update=function(){this.loadUrl(this.graphicsElement.getUrl());if(!this.isLoaded){window.setTimeout(jsgl.util.delegate(this,this.update),50);return}jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var size=this.graphicsElement.getSize(),location=this.graphicsElement.getLocation();var dPhi=Math.PI*this.graphicsElement.getRotation()/180;var origCX=0,origCY=0;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:origCX=location.X+size.X/2;break;case jsgl.HorizontalAnchor.CENTER:origCX=location.X;break;case jsgl.HorizontalAnchor.RIGHT:origCX=location.X-size.X/2;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:origCY=location.Y+size.Y/2;break;case jsgl.VerticalAnchor.MIDDLE:origCY=location.Y;break;case jsgl.VerticalAnchor.BOTTOM:origCY=location.Y-size.Y/2;break}var origPhi=Math.atan2(origCY-location.Y,origCX-location.X);var d=jsgl.Vector2D.getDistance(location,new jsgl.Vector2D(origCX,origCY));var trCX=location.X+Math.cos(origPhi+dPhi)*d;var trCY=location.Y+Math.sin(origPhi+dPhi)*d;this.vmlRectElement.style.left=trCX-size.X/2;this.vmlRectElement.style.top=trCY-size.Y/2;this.vmlRectElement.style.width=size.X;this.vmlRectElement.style.height=size.Y;this.vmlRectElement.style.rotation=this.graphicsElement.getRotation()%360;this.vmlFillElement.src=this.graphicsElement.getUrl();this.vmlFillElement.opacity=this.graphicsElement.getOpacity();this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement)};jsgl.elements.ShapeElement=function(domPresenter,panel){jsgl.elements.AbstractElement.call(this,panel);this.path=new jsgl.util.ArrayList();this.pathChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=domPresenter;this.domPresenter.setGraphicsElement(this)};jsgl.elements.ShapeElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.ShapeElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.ShapeElement.prototype.addPathSegment=function(segment){this.path.add(segment);segment.registerChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.getPathSegmentAt=function(index){return this.path.get(index)};jsgl.elements.ShapeElement.prototype.getPathSize=function(){return this.path.getCount()};jsgl.elements.ShapeElement.prototype.setPathSegmentAt=function(newSegment,index){if(this.path.get(index)){this.path.get(index).unregisterChangeListener(this.pathChangeListener)}this.path.setAt(segment,index);segment.registerChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.removePathSegmentAt=function(index){this.path.get(index).unregisterChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.insertPathSegmentAt=function(segment,index){this.path.insertAt(segment,index);segment.registerChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.clearPath=function(){var pathLength=this.path.getCount();for(var i=0;i<pathLength;i++){this.path.get(i).unregisterChangeListener(this.pathChangeListener)}this.path.clear();this.inChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.ShapeElement.prototype.setStroke=function(newStroke){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=newStroke;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.getFill=function(){return this.fill};jsgl.elements.ShapeElement.prototype.setFill=function(newFill){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=newFill;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgShapeDomPresenter=function(ownerDocument){jsgl.elements.AbstractDomPresenter.call(this);this.svgPathElement=ownerDocument.createElementNS("http://www.w3.org/2000/svg","path");this.svgPathElement.style.setProperty("fill-rule","evenodd",null);this.attachMouseHandlers(this.svgPathElement)};jsgl.elements.SvgShapeDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgShapeDomPresenter.prototype.getXmlElement=function(){return this.svgPathElement};jsgl.elements.SvgShapeDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var pathStr="";var pathSize=this.graphicsElement.getPathSize();for(var i=0;i<pathSize;i++){pathStr+=this.graphicsElement.getPathSegmentAt(i).toSvgCommand()}this.svgPathElement.setAttribute("d",pathStr);this.graphicsElement.getStroke().applyToSvgElement(this.svgPathElement);this.graphicsElement.getFill().applyToSvgElement(this.svgPathElement)};jsgl.elements.VmlShapeDomPresenter=function(ownerDocument){this.vmlShapeElement=document.createElement("vml:shape");this.vmlShapeElement.style.position="absolute";this.vmlShapeElement.coordsize=(1).jsglVmlize()+" "+(1).jsglVmlize();this.vmlShapeElement.style.width=this.vmlShapeElement.style.height=1;this.vmlStrokeElement=ownerDocument.createElement("vml:stroke");this.vmlShapeElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=ownerDocument.createElement("vml:fill");this.vmlShapeElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlShapeElement)};jsgl.elements.VmlShapeDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlShapeDomPresenter.prototype.getXmlElement=function(){return this.vmlShapeElement};jsgl.elements.VmlShapeDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlShapeDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlShapeDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var pathStr="",pathSize=this.graphicsElement.getPathSize();var pathHistory={currLoc:new jsgl.Vector2D(),lastStart:new jsgl.Vector2D()};for(var i=0;i<pathSize;i++){var pathSegment=this.graphicsElement.getPathSegmentAt(i);pathStr+=pathSegment.toVmlCommand(pathHistory);if(pathSegment.isCubicBezier()){pathHistory.lastCBCtl=pathSegment.getCBControlPoint(pathHistory)}else{pathHistory.lastCBCtl=pathSegment.getNewLocation(pathHistory)}if(pathSegment.isQuadraticBezier()){pathHistory.lastQBCtl=pathSegment.getQBControlPoint(pathHistory)}else{pathHistory.lastQBCtl=pathSegment.getNewLocation(pathHistory)}if(!pathSegment.closesSubpath()){pathHistory.currLoc=pathSegment.getNewLocation(pathHistory)}else{pathHistory.currLoc=jsgl.cloneObject(pathHistory.lastStart)}if(pathSegment.startsNewSubpath()){pathHistory.lastStart=jsgl.cloneObject(pathHistory.currLoc)}}this.vmlShapeElement.path=pathStr;this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.Panel=function(holderElement){this.holderElement=holderElement;this.elements=new jsgl.util.ArrayList();this.ownerDocument=null;if(jsgl.util.BrowserInfo.isMSIE55){this.ownerDocument=document}else{this.ownerDocument=holderElement.ownerDocument}this.holderElement.style.position="relative";this.holderElement.style.overflow="hidden";this.holderElement.style.cursor="default";this.domPresenter=null;if(jsgl.util.BrowserInfo.supportsSvg){this.domPresenter=new jsgl.panel.SvgPanelDomPresenter(this)}else{this.domPresenter=new jsgl.panel.NonSvgPanelDomPresenter(this)}this.cursor=jsgl.Cursor.INHERIT;this.mouseMoveRaiser=new jsgl.util.EventRaiser();this.mouseDownRaiser=new jsgl.util.EventRaiser();this.mouseUpRaiser=new jsgl.util.EventRaiser();this.mouseOverRaiser=new jsgl.util.EventRaiser();this.mouseOutRaiser=new jsgl.util.EventRaiser();this.clickRaiser=new jsgl.util.EventRaiser();this.dblClickRaiser=new jsgl.util.EventRaiser();this.contextMenuRaiser=new jsgl.util.EventRaiser()};jsgl.Panel.prototype.getHolderElement=function(){return this.holderElement};jsgl.Panel.prototype.getOwnerDocument=function(){return this.ownerDocument};jsgl.Panel.prototype.addElement=function(element){this.domPresenter.addElement(element);this.elements.add(element);element.setContainer(this)};jsgl.Panel.prototype.clear=function(){this.domPresenter.clear();this.elements.clear();for(i=0;i<this.elements.getCount();i++){this.elements.get(i).setContainer(null)}};jsgl.Panel.prototype.getElementsCount=function(){return this.elements.getCount()};jsgl.Panel.prototype.getElementAt=function(index){return this.elements.get(index)};jsgl.Panel.prototype.containsElement=function(element){return this.elements.contains(element)};jsgl.Panel.prototype.removeElement=function(element){this.domPresenter.removeElement(element);this.elements.remove(element);element.setContainer(null)};jsgl.Panel.prototype.createGroup=function(x,y,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgGroupDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.NonSvgGroupDomPresenter(this.ownerDocument)}return new jsgl.elements.GroupElement(domPresenter,this,x,y,zIndex)};jsgl.Panel.prototype.createCircle=function(x,y,radius,stroke,fill,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgCircleDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlCircleDomPresenter(this.ownerDocument)}return new jsgl.elements.CircleElement(domPresenter,this,x,y,radius,stroke,fill,zIndex)};jsgl.Panel.prototype.createEllipse=function(x,y,width,height,rotation,stroke,fill,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgEllipseDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlEllipseDomPresenter(this.ownerDocument)}return new jsgl.elements.EllipseElement(domPresenter,this,x,y,width,height,rotation,stroke,fill,zIndex)};jsgl.Panel.prototype.createRectangle=function(){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgRectangleDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlRectangleDomPresenter(this.ownerDocument)}return new jsgl.elements.RectangleElement(domPresenter,this)};jsgl.Panel.prototype.createLine=function(x1,y1,x2,y2,stroke,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgLineDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlLineDomPresenter(this.ownerDocument)}return new jsgl.elements.LineElement(domPresenter,this,x1,y1,x2,y2,stroke,zIndex)};jsgl.Panel.prototype.createLabel=function(x,y,text,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgLabelDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.NonSvgLabelDomPresenter(this.ownerDocument)}return new jsgl.elements.LabelElement(domPresenter,this,x,y,text,zIndex)};jsgl.Panel.prototype.createPolyline=function(stroke,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgPolylineDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlPolylineDomPresenter(this.ownerDocument)}return new jsgl.elements.PolylineElement(domPresenter,this,stroke,zIndex)};jsgl.Panel.prototype.createPolygon=function(stroke,fill,zIndex){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgPolygonDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlPolygonDomPresenter(this.ownerDocument)}return new jsgl.elements.PolygonElement(domPresenter,this,stroke,fill,zIndex)};jsgl.Panel.prototype.createImage=function(){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgImageDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlImageDomPresenter(this.ownerDocument)}return new jsgl.elements.ImageElement(domPresenter,this)};jsgl.Panel.prototype.createCurve=function(){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgCurveDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlCurveDomPresenter(this.ownerDocument)}return new jsgl.elements.CurveElement(domPresenter,this)};jsgl.Panel.prototype.createShape=function(){var domPresenter;if(jsgl.util.BrowserInfo.supportsSvg){domPresenter=new jsgl.elements.SvgShapeDomPresenter(this.ownerDocument)}else{domPresenter=new jsgl.elements.VmlShapeDomPresenter(this.ownerDocument)}return new jsgl.elements.ShapeElement(domPresenter,this)};jsgl.Panel.prototype.setCursor=function(newCursor){this.cursor=newCursor;this.domPresenter.update()};jsgl.Panel.prototype.getCursor=function(){return this.cursor};jsgl.Panel.prototype.addMouseMoveListener=function(listener){this.mouseMoveRaiser.registerListener(listener)};jsgl.Panel.prototype.removeMouseMoveListener=function(listener){this.mouseMoveRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseMouseMove=function(eventArgs){this.mouseMoveRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addMouseDownListener=function(listener){this.mouseDownRaiser.registerListener(listener)};jsgl.Panel.prototype.removeMouseDownListener=function(listener){this.mouseDownRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseMouseDown=function(eventArgs){this.mouseDownRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addMouseUpListener=function(listener){this.mouseUpRaiser.registerListener(listener)};jsgl.Panel.prototype.removeMouseUpListener=function(listener){this.mouseUpRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseMouseUp=function(eventArgs){this.mouseUpRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addMouseOverListener=function(listener){this.mouseOverRaiser.registerListener(listener)};jsgl.Panel.prototype.removeMouseOverListener=function(listener){this.mouseOverRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseMouseOver=function(eventArgs){this.mouseOverRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addMouseOutListener=function(listener){this.mouseOutRaiser.registerListener(listener)};jsgl.Panel.prototype.removeMouseOutListener=function(listener){this.mouseOutRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseMouseOut=function(eventArgs){this.mouseOutRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addClickListener=function(listener){this.clickRaiser.registerListener(listener)};jsgl.Panel.prototype.removeClickListener=function(listener){this.clickRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseClick=function(eventArgs){this.clickRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addContextMenuListener=function(listener){this.contextMenuRaiser.registerListener(listener)};jsgl.Panel.prototype.removeContextMenuListener=function(listener){this.contextMenuRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseContextMenu=function(eventArgs){this.contextMenuRaiser.raiseEvent(eventArgs)};jsgl.Panel.prototype.addDoubleClickListener=function(listener){this.dblClickRaiser.registerListener(listener)};jsgl.Panel.prototype.removeDoubleClickListener=function(listener){this.dblClickRaiser.unregisterListener(listener)};jsgl.Panel.prototype.raiseDoubleClick=function(eventArgs){this.dblClickRaiser.raiseEvent(eventArgs)};jsgl.panel.AbstractPanelDomPresenter=function(panelObject){this.panelObject=panelObject;this.holderElement=this.panelObject.getHolderElement();this.initMouseHandlers()};jsgl.panel.AbstractPanelDomPresenter.prototype.addElement=function(element){throw"Not implemented"};jsgl.panel.AbstractPanelDomPresenter.prototype.removeElement=function(element){throw"Not implemented"};jsgl.panel.AbstractPanelDomPresenter.prototype.clear=function(){throw"Not implemented"};jsgl.panel.AbstractPanelDomPresenter.prototype.update=function(){this.holderElement.style.cursor=this.panelObject.getCursor().asCSS};jsgl.panel.AbstractPanelDomPresenter.prototype.initMouseHandlers=function(){this.holderElement.onclick=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseClick(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.CLICK));return false});this.holderElement.oncontextmenu=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseContextMenu(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.CONTEXTMENU));return false});this.holderElement.ondblclick=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseDoubleClick(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.DOUBLE_CLICK));return false});this.holderElement.onmousedown=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseMouseDown(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.DOWN));return false});this.holderElement.onmouseup=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseMouseUp(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.UP));return false});this.holderElement.onmousemove=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseMouseMove(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.MOVE));return false});this.holderElement.onmouseover=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseMouseOver(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.OVER));return false});this.holderElement.onmouseout=jsgl.util.delegate(this,function(e){if(jsgl.util.BrowserInfo.usesWindowEvent){e=window.event}this.panelObject.raiseMouseOut(jsgl.MouseEvent.fromJsglPanel(e,this.panelObject,jsgl.MouseEvent.OUT));return false})};jsgl.panel.NonSvgPanelDomPresenter=function(panelObject){jsgl.panel.AbstractPanelDomPresenter.call(this,panelObject);this.elementsGroup=this.panelObject.createGroup();this.holderElement.appendChild(this.elementsGroup.getDomPresenter().getXmlElement());this.elementsGroup.setContainer(panelObject)};jsgl.panel.NonSvgPanelDomPresenter.jsglExtend(jsgl.panel.AbstractPanelDomPresenter);jsgl.panel.NonSvgPanelDomPresenter.prototype.addElement=function(element){this.elementsGroup.addElement(element)};jsgl.panel.NonSvgPanelDomPresenter.prototype.removeElement=function(element){this.elementsGroup.removeElement(element)};jsgl.panel.NonSvgPanelDomPresenter.prototype.clear=function(){this.elementsGroup.clear()};jsgl.panel.SvgPanelDomPresenter=function(panelObject){jsgl.panel.AbstractPanelDomPresenter.call(this,panelObject);this.svgHolder=this.panelObject.getOwnerDocument().createElementNS("http://www.w3.org/2000/svg","svg");this.svgHolder.style.position="absolute";this.svgHolder.style.left="0px";this.svgHolder.style.top="0px";this.holderElement.appendChild(this.svgHolder);this.domSorter=new jsgl.elements.DomSorter(this.svgHolder);this.lastSize=new jsgl.Vector2D();this.sizeUpdate();window.setInterval(jsgl.util.delegate(this,this.sizeUpdate),50)};jsgl.panel.SvgPanelDomPresenter.jsglExtend(jsgl.panel.AbstractPanelDomPresenter);jsgl.panel.SvgPanelDomPresenter.prototype.addElement=function(element){this.domSorter.add(element)};jsgl.panel.SvgPanelDomPresenter.prototype.removeElement=function(element){this.domSorter.remove(element)};jsgl.panel.SvgPanelDomPresenter.prototype.clear=function(){for(var i=0;i<this.panelObject.getElementsCount();i++){this.domSorter.remove(this.panelObject.getElementAt(i))}};jsgl.panel.SvgPanelDomPresenter.prototype.sizeUpdate=function(){if(this.lastSize.X!=this.holderElement.clientWidth||this.lastSize.Y!=this.holderElement.clientHeight){this.lastSize.X=this.holderElement.clientWidth;this.lastSize.Y=this.holderElement.clientHeight;this.svgHolder.setAttribute("width",this.lastSize.X);this.svgHolder.setAttribute("height",this.lastSize.Y)}};jsgl.DashStyles={DASH:jsgl.stroke.DashDashStyle.getInstance(),DASH_DOT:jsgl.stroke.DashDotDashStyle.getInstance(),DOT:jsgl.stroke.DotDashStyle.getInstance(),LONG_DASH:jsgl.stroke.LongDashDashStyle.getInstance(),LONG_DASH_DOT:jsgl.stroke.LongDashDotDashStyle.getInstance(),LONG_DASH_DOT_DOT:jsgl.stroke.LongDashDotDotDashStyle.getInstance(),SHORT_DASH_DOT:jsgl.stroke.ShortDashDotDashStyle.getInstance(),SOLID:jsgl.stroke.SolidDashStyle.getInstance()};jsgl.JoinStyles={ROUND:jsgl.stroke.RoundJoinStyle.getInstance(),BEVEL:jsgl.stroke.BevelJoinStyle.getInstance(),MITER:new jsgl.stroke.MiterJoinStyle(10)};jsgl.EndcapTypes={ROUND:jsgl.stroke.RoundEndcapType.getInstance(),FLAT:jsgl.stroke.FlatEndcapType.getInstance(),SQUARE:jsgl.stroke.SquareEndcapType.getInstance()};jsgl.Cursor={INHERIT:{asCSS:jsgl.util.BrowserInfo.isMSIE?"":"inherit"},DEFAULT:{asCSS:"default"},POINTER:{asCSS:"pointer"},CROSSHAIR:{asCSS:"crosshair"},HELP:{asCSS:"help"},TEXT:{asCSS:"text"},WAIT:{asCSS:"wait"},PROGRESS:{asCSS:"progress"},MOVE:{asCSS:"move"},N_RESIZE:{asCSS:"n-resize"},NE_RESIZE:{asCSS:"ne-resize"},E_RESIZE:{asCSS:"e-resize"},SE_RESIZE:{asCSS:"se-resize"},S_RESIZE:{asCSS:"s-resize"},SW_RESIZE:{asCSS:"sw-resize"},W_RESIZE:{asCSS:"w-resize"},NW_RESIZE:{asCSS:"nw-resize"}};jsgl.VerticalAnchor={TOP:0,BOTTOM:1,MIDDLE:2};jsgl.HorizontalAnchor={LEFT:0,RIGHT:1,CENTER:2};jsgl.MouseEvent=function(x,y,eventType,sourceElement,eventObject){this.eventType=eventType||jsgl.MouseEvent.UNKNOWN;this.location=new jsgl.Vector2D(x,y);this.sourceElement=sourceElement||null;this.eventObject=eventObject||null};jsgl.MouseEvent.fromJsglElement=function(eventObject,jsglElement,eventType){var location;if(jsgl.util.BrowserInfo.usesWindowEvent){if(jsgl.util.BrowserInfo.isOpera){location=new jsgl.Vector2D(eventObject.pageX,eventObject.pageY)}else{location=new jsgl.Vector2D(eventObject.x,eventObject.y)}location.X-=parseInt(jsglElement.getPanel().getHolderElement().style.borderLeftWidth)||0;location.Y-=parseInt(jsglElement.getPanel().getHolderElement().style.borderTopWidth)||0}else{location=new jsgl.Vector2D(eventObject.layerX,eventObject.layerY)}var panel=jsglElement.getPanel();var offset=new jsgl.Vector2D();var currContainer=jsglElement.getContainer();do{if(currContainer!=panel){offset=offset.add(currContainer.getLocation());currContainer=currContainer.getContainer()}}while(currContainer!=panel);if(jsgl.util.BrowserInfo.isOpera){var currElement=jsglElement.getPanel().getHolderElement();while(currElement!=document.body){offset.X+=currElement.offsetLeft;offset.Y+=currElement.offsetTop;currElement=currElement.offsetParent}}location=location.subtract(offset);var jsglElement=null,currElement=eventObject.srcElement||eventObject.target;do{if(currElement.jsglElement){jsglElement=currElement.jsglElement;break}currElement=currElement.parentNode}while(currElement!=document.body);return new jsgl.MouseEvent(location.X,location.Y,eventType,jsglElement,eventObject)};jsgl.MouseEvent.fromJsglPanel=function(eventObject,panelObject,eventType){var location=new jsgl.Vector2D();if(jsgl.util.BrowserInfo.usesWindowEvent){if(jsgl.util.BrowserInfo.isOpera){location=new jsgl.Vector2D(eventObject.pageX,eventObject.pageY)}else{location=new jsgl.Vector2D(eventObject.x,eventObject.y)}location.X-=parseInt(panelObject.getHolderElement().style.borderLeftWidth)||0;location.Y-=parseInt(panelObject.getHolderElement().style.borderTopWidth)||0}else{location=new jsgl.Vector2D(eventObject.layerX,eventObject.layerY)}if(jsgl.util.BrowserInfo.isOpera){var currElement=panelObject.getHolderElement();while(currElement!=document.body){location.X-=currElement.offsetLeft;location.Y-=currElement.offsetTop;currElement=currElement.offsetParent}}var jsglElement=null,currElement=eventObject.srcElement||eventObject.target;do{if(currElement.jsglElement){jsglElement=currElement.jsglElement;break}currElement=currElement.parentNode}while(currElement!=document.body);return new jsgl.MouseEvent(location.X,location.Y,eventType,jsglElement,eventObject)};jsgl.MouseEvent.UNKNOWN=0;jsgl.MouseEvent.CLICK=1;jsgl.MouseEvent.DOUBLE_CLICK=2;jsgl.MouseEvent.DOWN=3;jsgl.MouseEvent.UP=4;jsgl.MouseEvent.MOVE=5;jsgl.MouseEvent.OVER=6;jsgl.MouseEvent.OUT=7;jsgl.MouseEvent.CONTEXTMENU=8;jsgl.MouseEvent.prototype.getX=function(){return this.location.X};jsgl.MouseEvent.prototype.getY=function(){return this.location.Y};jsgl.MouseEvent.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.MouseEvent.prototype.getSourceElement=function(){return this.sourceElement};jsgl.MouseEvent.prototype.isAltKey=function(){return !!this.eventObject&&this.eventObject.altKey};jsgl.MouseEvent.prototype.isCtrlKey=function(){return !!this.eventObject&&this.eventObject.ctrlKey};jsgl.MouseEvent.prototype.isMetaKey=function(){return !!this.eventObject&&this.eventObject.metaKey};jsgl.MouseEvent.prototype.isShiftKey=function(){return !!this.eventObject&&this.eventObject.shiftKey};jsgl.MouseEvent.prototype.getEventType=function(){return this.eventType};jsgl.path.AbstractPathSegment=function(){this.onChangeRaiser=new jsgl.util.EventRaiser()};jsgl.path.AbstractPathSegment.prototype.registerChangeListener=function(listener){this.onChangeRaiser.registerListener(listener)};jsgl.path.AbstractPathSegment.prototype.unregisterChangeListener=function(listener){this.onChangeRaiser.unregisterListener(listener)};jsgl.path.AbstractPathSegment.prototype.toSvgCommand=function(){throw"not implemented"};jsgl.path.AbstractPathSegment.prototype.toVmlCommand=function(pathHistory){throw"not implemented"};jsgl.path.AbstractPathSegment.prototype.getNewLocation=function(pathHistory){return new jsgl.Vector2D(Number.NaN,Number.NaN)};jsgl.path.AbstractPathSegment.prototype.startsNewSubpath=function(){return false};jsgl.path.AbstractPathSegment.prototype.closesSubpath=function(){return false};jsgl.path.AbstractPathSegment.prototype.isCubicBezier=function(){return false};jsgl.path.AbstractPathSegment.prototype.getCBControlPoint=function(pathHistory){throw"not applicable"};jsgl.path.AbstractPathSegment.prototype.isQuadraticBezier=function(){return false};jsgl.path.AbstractPathSegment.prototype.getQBControlPoint=function(pathHistory){throw"not applicable"};jsgl.path.AbstractMoveTo=function(x,y){jsgl.path.AbstractPathSegment.call(this);this.location=new jsgl.Vector2D(x||0,y||0)};jsgl.path.AbstractMoveTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractMoveTo.prototype.getX=function(){return this.location.X};jsgl.path.AbstractMoveTo.prototype.setX=function(newX){this.location.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.getY=function(){return this.location.Y};jsgl.path.AbstractMoveTo.prototype.setY=function(newY){this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.path.AbstractMoveTo.prototype.setLocation=function(newLocation){this.location=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.setLocationXY=function(newX,newY){this.location.X=newX;this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.startsNewSubpath=function(){return true};jsgl.path.AbsoluteMoveTo=function(x,y){jsgl.path.AbstractMoveTo.call(this,x||0,y||0)};jsgl.path.AbsoluteMoveTo.jsglExtend(jsgl.path.AbstractMoveTo);jsgl.path.AbsoluteMoveTo.prototype.toSvgCommand=function(){return"M"+this.location.X+","+this.location.Y};jsgl.path.AbsoluteMoveTo.prototype.toVmlCommand=function(pathHistory){return"m"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.AbsoluteMoveTo.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.location)};jsgl.path.RelativeMoveTo=function(x,y){jsgl.path.AbstractMoveTo.call(this,x||0,y||0)};jsgl.path.RelativeMoveTo.jsglExtend(jsgl.path.AbstractMoveTo);jsgl.path.RelativeMoveTo.prototype.toSvgCommand=function(){return"m"+this.location.X+","+this.location.Y};jsgl.path.RelativeMoveTo.prototype.toVmlCommand=function(pathHistory){return"t"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.RelativeMoveTo.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.location)};jsgl.path.AbstractLineTo=function(x,y){jsgl.path.AbstractPathSegment.call(this);this.location=new jsgl.Vector2D(x||0,y||0)};jsgl.path.AbstractLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractLineTo.prototype.getX=function(){return this.location.X};jsgl.path.AbstractLineTo.prototype.setX=function(newX){this.location.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractLineTo.prototype.getY=function(){return this.location.Y};jsgl.path.AbstractLineTo.prototype.setY=function(newY){this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractLineTo.prototype.getEndPoint=function(){return jsgl.cloneObject(this.location)};jsgl.path.AbstractLineTo.prototype.setEndPoint=function(location){this.location=jsgl.cloneObject(location);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractLineTo.prototype.setEndPointXY=function(newX,newY){this.location.X=newX;this.location.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbsoluteLineTo=function(x,y){jsgl.path.AbstractLineTo.call(this,x||0,y||0)};jsgl.path.AbsoluteLineTo.jsglExtend(jsgl.path.AbstractLineTo);jsgl.path.AbsoluteLineTo.prototype.toSvgCommand=function(){return"L"+this.location.X+","+this.location.Y};jsgl.path.AbsoluteLineTo.prototype.toVmlCommand=function(pathHistory){return"l"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.AbsoluteLineTo.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.location)};jsgl.path.RelativeLineTo=function(x,y){jsgl.path.AbstractLineTo.call(this,x||0,y||0)};jsgl.path.RelativeLineTo.jsglExtend(jsgl.path.AbstractLineTo);jsgl.path.RelativeLineTo.prototype.toSvgCommand=function(){return"l"+this.location.X+","+this.location.Y};jsgl.path.RelativeLineTo.prototype.toVmlCommand=function(pathHistory){return"r"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.RelativeLineTo.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.location)};jsgl.path.ClosePath=function(){jsgl.path.AbstractPathSegment.call(this)};jsgl.path.ClosePath.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.ClosePath.prototype.toSvgCommand=function(){return"Z"};jsgl.path.ClosePath.prototype.toVmlCommand=function(pathHistory){return"xm"+(pathHistory.lastStart.X).jsglVmlize()+","+(pathHistory.lastStart.Y).jsglVmlize()};jsgl.path.ClosePath.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(pathHistory.currLoc)};jsgl.path.ClosePath.prototype.closesSubpath=function(){return true};jsgl.path.AbsoluteHorizontalLineTo=function(x){jsgl.path.AbstractPathSegment.call(this);this.x=x||0};jsgl.path.AbsoluteHorizontalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbsoluteHorizontalLineTo.prototype.getX=function(){return this.x};jsgl.path.AbsoluteHorizontalLineTo.prototype.setX=function(newX){this.x=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbsoluteHorizontalLineTo.prototype.toSvgCommand=function(){return"H"+this.x};jsgl.path.AbsoluteHorizontalLineTo.prototype.toVmlCommand=function(pathHisotry){return"l"+(this.x).jsglVmlize()+","+(pathHistory.currLoc.Y).jsglVmlize()};jsgl.path.AbsoluteHorizontalLineTo.prototype.getNewLocation=function(pathHistory){return new jsgl.Vector2D(this.x,pathHistory.currLoc.Y)};jsgl.path.RelativeHorizontalLineTo=function(x){jsgl.path.AbstractPathSegment.call(this);this.x=x||0};jsgl.path.RelativeHorizontalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.RelativeHorizontalLineTo.prototype.getX=function(){return this.x};jsgl.path.RelativeHorizontalLineTo.prototype.setX=function(newX){this.x=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.RelativeHorizontalLineTo.prototype.toSvgCommand=function(){return"h"+this.x};jsgl.path.RelativeHorizontalLineTo.prototype.toVmlCommand=function(pathHistory){return"r"+(this.x).jsglVmlize()+",0"};jsgl.path.RelativeHorizontalLineTo.prototype.getNewLocation=function(pathHistory){return new jsgl.Vector2D(pathHistory.currLoc.X+this.x,pathHistory.currLoc.Y)};jsgl.path.AbsoluteVerticalLineTo=function(y){jsgl.path.AbstractPathSegment.call(this);this.y=y||0};jsgl.path.AbsoluteVerticalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbsoluteVerticalLineTo.prototype.getY=function(){return this.y};jsgl.path.AbsoluteVerticalLineTo.prototype.setY=function(newY){this.y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbsoluteVerticalLineTo.prototype.toSvgCommand=function(){return"V"+this.y};jsgl.path.AbsoluteVerticalLineTo.prototype.toVmlCommand=function(pathHistory){return"l"+(pathHistory.currLoc.X).jsglVmlize()+","+(this.y).jsglVmlize()};jsgl.path.AbsoluteVerticalLineTo.prototype.getNewLocation=function(pathHistory){return new jsgl.Vector2D(pathHistory.currLoc.X,this.y)};jsgl.path.RelativeVerticalLineTo=function(y){jsgl.path.AbstractPathSegment.call(this);this.y=y||0};jsgl.path.RelativeVerticalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.RelativeVerticalLineTo.prototype.getY=function(){return this.y};jsgl.path.RelativeVerticalLineTo.prototype.setY=function(newY){this.y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.RelativeVerticalLineTo.prototype.toSvgCommand=function(){return"v"+this.y};jsgl.path.RelativeVerticalLineTo.prototype.toVmlCommand=function(pathHistory){return"r0,"+(this.y).jsglVmlize()};jsgl.path.RelativeVerticalLineTo.prototype.getNewLocation=function(pathHistory){return new jsgl.Vector2D(pathHistory.currLoc.X,pathHistory.currLoc.Y+this.y)};jsgl.path.AbstractCubicBezier=function(c1x,c1y,c2x,c2y,endX,endY){jsgl.path.AbstractPathSegment.call(this);this.control1=new jsgl.Vector2D(c1x||0,c1y||0);this.control2=new jsgl.Vector2D(c2x||0,c2y||0);this.endPoint=new jsgl.Vector2D(endX||0,endY||0)};jsgl.path.AbstractCubicBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractCubicBezier.prototype.getControl1X=function(){return this.control1.X};jsgl.path.AbstractCubicBezier.prototype.setControl1X=function(newX){this.control1.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl1Y=function(){return this.control1.Y};jsgl.path.AbstractCubicBezier.prototype.setControl1Y=function(newY){this.control1.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl1Point=function(){return jsgl.cloneObject(this.control1)};jsgl.path.AbstractCubicBezier.prototype.setControl1Point=function(newLocation){this.control1=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl2X=function(){return this.control2.X};jsgl.path.AbstractCubicBezier.prototype.setControl2X=function(newX){this.control2.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl2Y=function(){return this.control2.Y};jsgl.path.AbstractCubicBezier.prototype.setControl2Y=function(newY){this.control2.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl2Point=function(){return jsgl.cloneObject(this.control2)};jsgl.path.AbstractCubicBezier.prototype.setControl2Point=function(newLocation){this.control2=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractCubicBezier.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractCubicBezier.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractCubicBezier.prototype.setEndPoint=function(newLocation){this.endPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.isCubicBezier=function(){return true};jsgl.path.AbsoluteCubicBezier=function(c1x,c1y,c2x,c2y,endX,endY){jsgl.path.AbstractCubicBezier.call(this,c1x||0,c1y||0,c2x||0,c2y||0,endX||0,endY||0)};jsgl.path.AbsoluteCubicBezier.jsglExtend(jsgl.path.AbstractCubicBezier);jsgl.path.AbsoluteCubicBezier.prototype.toSvgCommand=function(){return"C"+this.control1.X+","+this.control1.Y+","+this.control2.X+","+this.control2.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteCubicBezier.prototype.toVmlCommand=function(pathHistory){return"c"+(this.control1.X).jsglVmlize()+","+(this.control1.Y).jsglVmlize()+","+(this.control2.X).jsglVmlize()+","+(this.control2.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteCubicBezier.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteCubicBezier.prototype.getCBControlPoint=function(pathHistory){return jsgl.cloneObject(this.control2)};jsgl.path.RelativeCubicBezier=function(c1x,c1y,c2x,c2y,endX,endY){jsgl.path.AbstractCubicBezier.call(this,c1x||0,c1y||0,c2x||0,c2y||0,endX||0,endY||0)};jsgl.path.RelativeCubicBezier.jsglExtend(jsgl.path.AbstractCubicBezier);jsgl.path.RelativeCubicBezier.prototype.toSvgCommand=function(){return"c"+this.control1.X+","+this.control1.Y+","+this.control2.X+","+this.control2.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeCubicBezier.prototype.toVmlCommand=function(pathHistory){return"v"+(this.control1.X).jsglVmlize()+","+(this.control1.Y).jsglVmlize()+","+(this.control2.X).jsglVmlize()+","+(this.control2.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeCubicBezier.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.endPoint)};jsgl.path.RelativeCubicBezier.prototype.getCBControlPoint=function(pathHistory){return pathHistory.currLoc.add(this.control2)};jsgl.path.AbstractSmoothCubicBezier=function(controlX,controlY,endX,endY){jsgl.path.AbstractPathSegment.call(this);this.controlPoint=new jsgl.Vector2D(controlX||0,controlY||0);this.endPoint=new jsgl.Vector2D(endX||0,endY||0)};jsgl.path.AbstractSmoothCubicBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractSmoothCubicBezier.prototype.getControlX=function(){return this.controlPoint.X};jsgl.path.AbstractSmoothCubicBezier.prototype.setControlX=function(newX){this.controlPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getControlY=function(){return this.controlPoint.Y};jsgl.path.AbstractSmoothCubicBezier.prototype.setControlY=function(newY){this.controlPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getControlPoint=function(){return this.controlPoint};jsgl.path.AbstractSmoothCubicBezier.prototype.setControlPoint=function(newLocation){this.controlPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractSmoothCubicBezier.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractSmoothCubicBezier.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getEndPoint=function(){return this.endPoint};jsgl.path.AbstractSmoothCubicBezier.prototype.setEndPoint=function(newLocation){this.endPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.isCubicBezier=function(){return true};jsgl.path.AbsoluteSmoothCubicBezier=function(controlX,controlY,endX,endY){jsgl.path.AbstractSmoothCubicBezier.call(this,controlX||0,controlY||0,endX||0,endY||0)};jsgl.path.AbsoluteSmoothCubicBezier.jsglExtend(jsgl.path.AbstractSmoothCubicBezier);jsgl.path.AbsoluteSmoothCubicBezier.prototype.toSvgCommand=function(){return"S"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteSmoothCubicBezier.prototype.toVmlCommand=function(pathHistory){var newCtlPoint=new jsgl.Vector2D(2*pathHistory.currLoc.X-pathHistory.lastCBCtl.X,2*pathHistory.currLoc.Y-pathHistory.lastCBCtl.Y);return"c"+(newCtlPoint.X).jsglVmlize()+","+(newCtlPoint.Y).jsglVmlize()+","+(this.controlPoint.X).jsglVmlize()+","+(this.controlPoint.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteSmoothCubicBezier.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteSmoothCubicBezier.prototype.getCBControlPoint=function(pathHistory){return jsgl.cloneObject(this.controlPoint)};jsgl.path.RelativeSmoothCubicBezier=function(controlX,controlY,endX,endY){jsgl.path.AbstractSmoothCubicBezier.call(this,controlX||0,controlY||0,endX||0,endY||0)};jsgl.path.RelativeSmoothCubicBezier.jsglExtend(jsgl.path.AbstractSmoothCubicBezier);jsgl.path.RelativeSmoothCubicBezier.prototype.toSvgCommand=function(){return"s"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeSmoothCubicBezier.prototype.toVmlCommand=function(pathHistory){var newCtlPoint=new jsgl.Vector2D(pathHistory.currLoc.X-pathHistory.lastCBCtl.X,pathHistory.currLoc.Y-pathHistory.lastCBCtl.Y);return"v"+(newCtlPoint.X).jsglVmlize()+","+(newCtlPoint.Y).jsglVmlize()+","+(this.controlPoint.X).jsglVmlize()+","+(this.controlPoint.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeSmoothCubicBezier.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.endPoint)};jsgl.path.RelativeSmoothCubicBezier.prototype.getCBControlPoint=function(pathHistory){return pathHistory.currLoc.add(this.controlPoint)};jsgl.path.AbstractQuadraticBezier=function(controlX,controlY,endX,endY){jsgl.path.AbstractPathSegment.call(this);this.controlPoint=new jsgl.Vector2D(controlX||0,controlY||0);this.endPoint=new jsgl.Vector2D(endX||0,endY||0)};jsgl.path.AbstractQuadraticBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractQuadraticBezier.prototype.getControlX=function(){return this.controlPoint.X};jsgl.path.AbstractQuadraticBezier.prototype.setControlX=function(newX){this.controlPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getControlY=function(){return this.controlPoint.Y};jsgl.path.AbstractQuadraticBezier.prototype.setControlY=function(newY){this.controlPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getControlPoint=function(){return jsgl.cloneObject(this.controlPoint)};jsgl.path.AbstractQuadraticBezier.prototype.setControlPoint=function(newLocation){this.controlPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractQuadraticBezier.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractQuadraticBezier.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractQuadraticBezier.prototype.setEndPoint=function(newLocation){this.endPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.isQuadraticBezier=function(){return true};jsgl.path.AbsoluteQuadraticBezier=function(controlX,controlY,endX,endY){jsgl.path.AbstractQuadraticBezier.call(this,controlX||0,controlY||0,endX||0,endY||0)};jsgl.path.AbsoluteQuadraticBezier.jsglExtend(jsgl.path.AbstractQuadraticBezier);jsgl.path.AbsoluteQuadraticBezier.prototype.toSvgCommand=function(){return"Q"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteQuadraticBezier.prototype.toVmlCommand=function(pathHistory){return"c"+((pathHistory.currLoc.X+2*this.controlPoint.X)/3).jsglVmlize()+","+((pathHistory.currLoc.Y+2*this.controlPoint.Y)/3).jsglVmlize()+","+((2*this.controlPoint.X+this.endPoint.X)/3).jsglVmlize()+","+((2*this.controlPoint.Y+this.endPoint.Y)/3).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteQuadraticBezier.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteQuadraticBezier.prototype.getQBControlPoint=function(pathHistory){return jsgl.cloneObject(this.controlPoint)};jsgl.path.RelativeQuadraticBezier=function(controlX,controlY,endX,endY){jsgl.path.AbstractQuadraticBezier.call(this,controlX||0,controlY||0,endX||0,endY||0)};jsgl.path.RelativeQuadraticBezier.jsglExtend(jsgl.path.AbstractQuadraticBezier);jsgl.path.RelativeQuadraticBezier.prototype.toSvgCommand=function(){return"q"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeQuadraticBezier.prototype.toVmlCommand=function(pathHistory){return"c"+(pathHistory.currLoc.X+(2*this.controlPoint.X)/3).jsglVmlize()+","+(pathHistory.currLoc.Y+(2*this.controlPoint.Y)/3).jsglVmlize()+","+(pathHistory.currLoc.X+(2*this.controlPoint.X+this.endPoint.X)/3).jsglVmlize()+","+(pathHistory.currLoc.Y+(2*this.controlPoint.Y+this.endPoint.Y)/3).jsglVmlize()+","+(pathHistory.currLoc.X+this.endPoint.X).jsglVmlize()+","+(pathHistory.currLoc.Y+this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeQuadraticBezier.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.endPoint)};jsgl.path.RelativeQuadraticBezier.prototype.getQBControlPoint=function(pathHistory){return pathHistory.currLoc.add(this.controlPoint)};jsgl.path.AbstractSmoothQuadraticBezier=function(x,y){jsgl.path.AbstractPathSegment.call(this);this.endPoint=new jsgl.Vector2D(x||0,y||0)};jsgl.path.AbstractSmoothQuadraticBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractSmoothQuadraticBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractSmoothQuadraticBezier.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothQuadraticBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractSmoothQuadraticBezier.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothQuadraticBezier.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractSmoothQuadraticBezier.prototype.setEndPoint=function(newLocation){this.endPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent(newLocation)};jsgl.path.AbstractSmoothQuadraticBezier.prototype.isQuadraticBezier=function(){return true};jsgl.path.AbsoluteSmoothQuadraticBezier=function(x,y){jsgl.path.AbstractSmoothQuadraticBezier.call(this,x||0,y||0)};jsgl.path.AbsoluteSmoothQuadraticBezier.jsglExtend(jsgl.path.AbstractSmoothQuadraticBezier);jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.toSvgCommand=function(){return"T"+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.toVmlCommand=function(pathHistory){var newCtlPoint=new jsgl.Vector2D(2*pathHistory.currLoc.X-pathHistory.lastQBCtl.X,2*pathHistory.currLoc.Y-pathHistory.lastQBCtl.Y);return"c"+((pathHistory.currLoc.X+2*newCtlPoint.X)/3).jsglVmlize()+","+((pathHistory.currLoc.Y+2*newCtlPoint.Y)/3).jsglVmlize()+","+((2*newCtlPoint.X+this.endPoint.X)/3).jsglVmlize()+","+((2*newCtlPoint.Y+this.endPoint.Y)/3).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.getQBControlPoint=function(pathHistory){return newCtlPoint=new jsgl.Vector2D(2*pathHistory.currLoc.X-pathHistory.lastQBCtl.X,2*pathHistory.currLoc.Y-pathHistory.lastQBCtl.Y)};jsgl.path.RelativeSmoothQuadraticBezier=function(x,y){jsgl.path.AbstractSmoothQuadraticBezier.call(this,x||0,y||0)};jsgl.path.RelativeSmoothQuadraticBezier.jsglExtend(jsgl.path.AbstractSmoothQuadraticBezier);jsgl.path.RelativeSmoothQuadraticBezier.prototype.toSvgCommand=function(){return"t"+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeSmoothQuadraticBezier.prototype.toVmlCommand=function(pathHistory){var newCtlPoint=new jsgl.Vector2D(pathHistory.currLoc.X-pathHistory.lastQBCtl.X,pathHistory.currLoc.Y-pathHistory.lastQBCtl.Y);return"v"+((2*newCtlPoint.X)/3).jsglVmlize()+","+((2*newCtlPoint.Y)/3).jsglVmlize()+","+((2*newCtlPoint.X+this.endPoint.X)/3).jsglVmlize()+","+((2*newCtlPoint.Y+this.endPoint.Y)/3).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeSmoothQuadraticBezier.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.endPoint)};jsgl.path.RelativeSmoothQuadraticBezier.prototype.getQBControlPoint=function(pathHistory){return new jsgl.Vector2D(2*pathHistory.currLoc.X-pathHistory.lastQBCtl.X,2*pathHistory.currLoc.Y-pathHistory.lastQBCtl.Y)};jsgl.path.AbstractEllipticalArc=function(rx,ry,rotation,largeArc,sweep,endX,endY){jsgl.path.AbstractPathSegment.call(this);this.radii=new jsgl.Vector2D(rx||0,ry||0);this.rotation=rotation||0;this.largeArc=!!largeArc;this.sweep=!!sweep;this.endPoint=new jsgl.Vector2D(endX||0,endY||0)};jsgl.path.AbstractEllipticalArc.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractEllipticalArc.prototype.getXRadius=function(){return this.radii.X};jsgl.path.AbstractEllipticalArc.prototype.setXRadius=function(newRX){this.radii.X=newRX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getYRadius=function(){return this.radii.Y};jsgl.path.AbstractEllipticalArc.prototype.setYRadius=function(newRY){this.radii.Y=newRY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getRadii=function(){return jsgl.cloneObject(this.radii)};jsgl.path.AbstractEllipticalArc.prototype.setRadii=function(newRadii){this.radii=jsgl.cloneObject(newRadii);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.setRadiiXY=function(newRX,newRY){this.radii=new jsgl.Vector2D(newRX,newRY);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getRotation=function(){return this.rotation};jsgl.path.AbstractEllipticalArc.prototype.setRotation=function(newRotation){this.rotation=newRotation;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getLargeArc=function(){return this.largeArc};jsgl.path.AbstractEllipticalArc.prototype.setLargeArc=function(largeArc){this.largeArc=!!largeArc;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getSweep=function(){return this.sweep};jsgl.path.AbstractEllipticalArc.prototype.setSweep=function(sweep){this.sweep=!!sweep;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractEllipticalArc.prototype.setEndX=function(newX){this.endPoint.X=newX;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractEllipticalArc.prototype.setEndY=function(newY){this.endPoint.Y=newY;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractEllipticalArc.prototype.setEndPoint=function(newLocation){this.endPoint=jsgl.cloneObject(newLocation);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.setEndPointXY=function(newX,newY){this.endPoint=new jsgl.Vector2D(newX,newY);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.bezierApproximation=function(x1,y1,phi,rx,ry,x2,y2,numInterpols){var rx=Math.abs(rx),ry=Math.abs(ry),phi=Math.PI*phi/180,ca=Math.cos(phi),sa=Math.sin(phi);if((rx==0&&ry==0)||(x1==x2&&y1==y2)){return"l"+x1.jsglVmlize()+","+y1.jsglVmlize()+","+x2.jsglVmlize()+","+y2.jsglVmlize()}var xs1=(ca*(x1-x2)+sa*(y1-y2))/2,ys1=(-sa*(x1-x2)+ca*(y1-y2))/2,lambda=Math.sqrt((xs1*xs1)/(rx*rx)+(ys1*ys1)/(ry*ry));if(lambda>1){rx*=lambda;ry*=lambda}var fA=this.largeArc,fS=this.sweep,mltp=(fA==fS)?-1:1,wt1=rx*rx*ry*ry;wt2=rx*rx*ys1*ys1+ry*ry*xs1*xs1,root=Math.sqrt(Math.max(0,wt1/wt2-1)),cxs=mltp*root*rx*ys1/ry,cys=-mltp*root*ry*xs1/rx,cx=ca*cxs-sa*cys+(x1+x2)/2,cy=sa*cxs+ca*cys+(y1+y2)/2,xt1=ca*(x1-cx)+sa*(y1-cy),yt1=-sa*(x1-cx)+ca*(y1-cy),xt2=ca*(x2-cx)+sa*(y2-cy),yt2=-sa*(x2-cx)+ca*(y2-cy),th1=xt1/rx,th2=yt1/ry,th3=xt2/rx,th4=yt2/ry,vh=(yt1>=0?1:-1),vg=(yt2>=0?1:-1),theta1=vh*Math.acos(th1/Math.sqrt(th1*th1+th2*th2)),theta2=vg*Math.acos(th3/Math.sqrt(th3*th3+th4*th4)),dtheta=Math.abs(theta2-theta1),dthetb=Math.abs(dtheta-2*Math.PI);if(fA){dtheta=Math.max(dtheta,dthetb)}else{dtheta=Math.min(dtheta,dthetb)}if(!fS){dtheta*=-1}var dPhi=dtheta/numInterpols,data=[];for(var i=0;i<=numInterpols;i++){data[i]=[];var tt=i*dPhi,cpi=Math.cos(tt+theta1),spi=Math.sin(tt+theta1),xx=rx*cpi,yy=ry*spi,dx=-dPhi*rx*spi,dy=dPhi*ry*cpi;data[i][0]=ca*xx-sa*yy+cx;data[i][1]=sa*xx+ca*yy+cy;data[i][2]=ca*dx-sa*dy;data[i][3]=sa*dx+ca*dy}var cpx=data[0][0]+data[0][2]/3,cpy=data[0][1]+data[0][3]/3;var cq=[];for(var i=0;i<=numInterpols;i++){cq[i]={x:data[i][0]-data[i][2]/3,y:data[i][1]-data[i][3]/3}}var result="l"+data[0][0].jsglVmlize()+","+data[0][1].jsglVmlize()+"c"+cpx.jsglVmlize()+","+cpy.jsglVmlize()+","+cq[1].x.jsglVmlize()+","+cq[1].y.jsglVmlize()+","+data[1][0].jsglVmlize()+","+data[1][1].jsglVmlize();for(var i=2;i<=numInterpols;i++){result+="c"+(2*data[i-1][0]-cq[i-1].x).jsglVmlize()+","+(2*data[i-1][1]-cq[i-1].y).jsglVmlize()+","+cq[i].x.jsglVmlize()+","+cq[i].y.jsglVmlize()+","+data[i][0].jsglVmlize()+","+data[i][1].jsglVmlize()}return result};jsgl.path.AbsoluteEllipticalArc=function(rx,ry,rotation,largeArc,sweep,endX,endY){jsgl.path.AbstractEllipticalArc.call(this,rx||0,ry||0,rotation||0,!!largeArc,!!sweep,endX||0,endY||0)};jsgl.path.AbsoluteEllipticalArc.jsglExtend(jsgl.path.AbstractEllipticalArc);jsgl.path.AbsoluteEllipticalArc.prototype.toSvgCommand=function(){return"A"+this.radii.X+","+this.radii.Y+","+this.rotation+","+(this.largeArc?"1":"0")+","+(this.sweep?"1":"0")+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteEllipticalArc.prototype.toVmlCommand=function(pathHistory){return this.bezierApproximation(pathHistory.currLoc.X,pathHistory.currLoc.Y,this.rotation,this.radii.X,this.radii.Y,this.endPoint.X,this.endPoint.Y,16)};jsgl.path.AbsoluteEllipticalArc.prototype.getNewLocation=function(pathHistory){return jsgl.cloneObject(this.endPoint)};jsgl.path.RelativeEllipticalArc=function(rx,ry,rotation,largeArc,sweep,endX,endY){jsgl.path.AbstractEllipticalArc.call(this,rx||0,ry||0,rotation||0,!!largeArc,!!sweep,endX||0,endY||0)};jsgl.path.RelativeEllipticalArc.jsglExtend(jsgl.path.AbstractEllipticalArc);jsgl.path.RelativeEllipticalArc.prototype.toSvgCommand=function(){return"a"+this.radii.X+","+this.radii.Y+","+this.rotation+","+(this.largeArc?"1":"0")+","+(this.sweep?"1":"0")+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeEllipticalArc.prototype.toVmlCommand=function(pathHistory){return this.bezierApproximation(pathHistory.currLoc.X,pathHistory.currLoc.Y,this.rotation,this.radii.X,this.radii.Y,pathHistory.currLoc.X+this.endPoint.X,pathHistory.currLoc.Y+this.endPoint.Y,16)};jsgl.path.RelativeEllipticalArc.prototype.getNewLocation=function(pathHistory){return pathHistory.currLoc.add(this.endPoint)};